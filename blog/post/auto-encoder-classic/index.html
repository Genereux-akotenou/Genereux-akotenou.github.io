<!DOCTYPE html><html lang="en" class="scroll-smooth" data-astro-cid-37fxchfa> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.0.8"><!-- Canonical URL --><link rel="canonical" href="https://genereux-akotenou.github.io/blog/post/auto-encoder-classic/"><!-- Primary Meta Tags --><title>Encoder-Decoder Architecture: How Neural Networks Understand Sequences â€¢ GÃ©nÃ©reux Akotenou&#39;s Blog</title><!-- ViewTransitions  --><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><!-- SEO --><meta name="title" content="Encoder-Decoder Architecture: How Neural Networks Understand Sequences â€¢ GÃ©nÃ©reux Akotenou's Blog"><meta name="description" content="This article explores the core components of Encoder-Decoder models, their applications in sequence-to-sequence tasks, and how they enable powerful deep learning solutions for text translation, summarization, and more.
"><meta name="author" content="GÃ©nÃ©reux Akotenou"><!-- Open Graph / Facebook --><meta property="og:type" content="article"><meta property="og:url" content="https://genereux-akotenou.github.io/blog/post/auto-encoder-classic/"><meta property="og:title" content="Encoder-Decoder Architecture: How Neural Networks Understand Sequences"><meta property="og:description" content="This article explores the core components of Encoder-Decoder models, their applications in sequence-to-sequence tasks, and how they enable powerful deep learning solutions for text translation, summarization, and more.
"><meta property="og:image" content="https://genereux-akotenou.github.io/_astro/banner.DYXKxOkz.png"><meta property="article:author" content="GÃ©nÃ©reux Akotenou"><meta property="article:published_time" content="2025-06-08T08:00:00.000Z"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://genereux-akotenou.github.io/blog/post/auto-encoder-classic/"><meta property="twitter:title" content="Encoder-Decoder Architecture: How Neural Networks Understand Sequences"><meta property="twitter:description" content="This article explores the core components of Encoder-Decoder models, their applications in sequence-to-sequence tasks, and how they enable powerful deep learning solutions for text translation, summarization, and more.
"><meta property="twitter:image" content="https://genereux-akotenou.github.io/_astro/banner.DYXKxOkz.png"><!-- RSS auto-discovery --><link rel="alternate" type="application/rss+xml" title="GÃ©nÃ©reux Akotenou's Blog" href="/rss.xml"><link as="font" crossorigin rel="preload" href="/fonts/Manrope-Bold.woff2" type="font/woff2"><style>@font-face {font-weight: 200;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-ExtraLight.woff2)}</style><style>@font-face {font-weight: 300;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Light.woff2)}</style><style>@font-face {font-weight: 400;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Regular.woff2)}</style><style>@font-face {font-weight: 500;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Medium.woff2)}</style><style>@font-face {font-weight: 600;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-SemiBold.woff2)}</style><style>@font-face {font-weight: 700;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Bold.woff2)}</style><style>@font-face {font-weight: 800;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-ExtraBold.woff2)}</style><style>@font-face { font-family: _font_fallback_1749647227512; size-adjust: 103.76%; src: local('Arial'); ascent-override: 102.74%; descent-override: 28.91%; line-gap-override: 0.00%; }</style><script>
	function getTheme() {
		const storedTheme = typeof localStorage !== 'undefined' && localStorage.getItem('theme')

		return (
			storedTheme || (window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark')
		)
	}

	function setTheme(newTheme) {
		const html = document.documentElement
		const isDark = newTheme === 'dark'

		html.classList.toggle('dark', isDark)
		html.classList.toggle('light', !isDark)

		localStorage.setItem('theme', newTheme)
	}

	// set initial theme
	setTheme(getTheme())
	document.addEventListener('astro:after-swap', () => setTheme(getTheme()))

	document.addEventListener('theme-change', (e) => {
		setTheme(e.detail.theme)
	})
</script><script>
	if (!('animations' in localStorage)) {
		localStorage.setItem('animations', 'true')
	} else {
		localStorage.setItem('animations', 'false')
	}
</script><link rel="stylesheet" href="/_astro/_page_.xHbViqlC.css" />
<link rel="stylesheet" href="/_astro/_slug_.4EtQgQGW.css" />
<style>.embed-refresh-v2[data-astro-cid-r2x3s5wt] .nav-primary--refresh[data-astro-cid-r2x3s5wt]{margin-bottom:24px;border-bottom:1px solid #c2c6cc!important}@media (min-width: 768px){.md\:text-6xl[data-astro-cid-l3utfwjv]{font-size:3rem!important;line-height:1}.md\:prose-xl[data-astro-cid-l3utfwjv] :where(h1):not(:where([class~=not-prose],[class~=not-prose] *))[data-astro-cid-l3utfwjv]{font-size:2em!important;margin-top:0;margin-bottom:.8571429em;line-height:1}.md\:prose-xl[data-astro-cid-l3utfwjv] :where(h2):not(:where([class~=not-prose],[class~=not-prose] *))[data-astro-cid-l3utfwjv]{font-size:1.3em!important;margin-top:1.5555556em;margin-bottom:.8888889em;line-height:1.1111111}}
</style><script type="module" src="/_astro/hoisted.De9_3LE1.js"></script></head> <body class="bg-white text-stone-950 dark:bg-[#0a0910] dark:text-white" data-astro-cid-37fxchfa> <main class="px-5 sm:mx-auto sm:max-w-2xl sm:px-8 lg:px-0 antialiased md:max-w-6xl grid gap-12 mt-4 overflow-hidden md:overflow-visible" data-astro-cid-37fxchfa> <header class="relative flex items-center h-12 font-semibold" data-astro-cid-3ef6ksr2> <span style="display: flex; flex-direction: row;" class="text-lg mr-auto" data-astro-cid-3ef6ksr2> <a class="nav-link" href="/" data-astro-cid-3ef6ksr2>Resume</a>&nbsp;&nbsp;&nbsp;
<a class="nav-link active" href="/blog" data-astro-cid-3ef6ksr2>Blog</a>&nbsp;&nbsp;&nbsp;
<!--<a class={cn(`nav-link`, busIsActive && `active`)} href='/startup'>Business</a>&nbsp;&nbsp;-&nbsp;&nbsp;--> <a class="nav-link" href="/fun" data-astro-cid-3ef6ksr2>Coding ðŸŽ‰</a>&nbsp;&nbsp;&nbsp;
<!--<a class={cn(`nav-link`, travelIsActive && `active`)} href='/travel'>Travel ðŸŽ‰</a>--> </span> <div id="astro-header-drawer" class="shadow rounded-l-lg md:bg-transparent dark:md:bg-transparent bg-white dark:bg-[#0a0910] md:shadow-none md:rounded-none md:border-none md:h-auto md:static absolute transition-transform duration-300 ease-in translate-x-96 md:translate-x-0 top-12 -right-5 pl-4 pt-6 pb-4 md:p-0 h-[200px] w-[200px] z-50" data-astro-cid-3ef6ksr2> <nav class="flex h-full flex-col justify-between gap-12 text-left md:flex-row md:w-full md:gap-5" data-astro-cid-3ef6ksr2> <div class="flex flex-col gap-4 md:flex-row md:border-r-2 border-black pr-4 dark:border-white" data-astro-cid-3ef6ksr2> <a href="/blog/tags" class="text-opacity-60 flex items-center gap-1 text-2xl md:text-base" rel="noopener noreferrer " data-astro-cid-3ef6ksr2>  <svg xmlns="http://www.w3.org/2000/svg" class="w-8 md:w-6" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M7.859 6h-2.834a2.025 2.025 0 0 0 -2.025 2.025v2.834c0 .537 .213 1.052 .593 1.432l6.116 6.116a2.025 2.025 0 0 0 2.864 0l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-6.117 -6.116a2.025 2.025 0 0 0 -1.431 -.593z"></path> <path d="M17.573 18.407l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-7.117 -7.116"></path> <path d="M6 9h-.01"></path> </svg> Tags
 </a> </div> <div class="flex justify-center items-center md:justify-end gap-3 md:p-0" data-astro-cid-3ef6ksr2> <a href="https://github.com/Genereux-akotenou" class="text-opacity-60" rel="noopener noreferrer " target="_blank" aria-label="Github" data-astro-cid-3ef6ksr2>  <span data-astro-cid-3ef6ksr2><svg xmlns="http://www.w3.org/2000/svg" class="w-8 md:w-6" viewBox="0 0 24 24" stroke-width="1.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path> </svg> </span>  </a><a href="https://www.linkedin.com/in/genereux-akotenou/" class="text-opacity-60" rel="noopener noreferrer " target="_blank" aria-label="linkedin" data-astro-cid-3ef6ksr2>  <span data-astro-cid-3ef6ksr2><svg enable-background="new 0 0 32 32" height="32px" id="Layer_1" version="1.0" viewBox="0 0 32 32" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M32,30c0,1.104-0.896,2-2,2H2c-1.104,0-2-0.896-2-2V2c0-1.104,0.896-2,2-2h28c1.104,0,2,0.896,2,2V30z" fill="#007BB5"></path><g><rect fill="#FFFFFF" height="14" width="4" x="7" y="11"></rect><path d="M20.499,11c-2.791,0-3.271,1.018-3.499,2v-2h-4v14h4v-8c0-1.297,0.703-2,2-2c1.266,0,2,0.688,2,2v8h4v-7    C25,14,24.479,11,20.499,11z" fill="#FFFFFF"></path><circle cx="9" cy="8" fill="#FFFFFF" r="2"></circle></g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg> </span>  </a> </div> </nav> </div> <div class="flex items-center gap-3 md:pl-3" data-astro-transition-persist="navbar" data-astro-cid-3ef6ksr2> <div data-astro-cid-3ef6ksr2> <site-search id="search" class="ms-auto"> <button data-open-modal disabled class="flex items-center justify-center rounded-md gap-1"> <svg aria-label="search" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"> <path stroke="none" d="M0 0h24v24H0z"></path> <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path> </svg> <!-- <span class='md:hidden text-2xl'> Search</span> --> </button> <dialog aria-label="search" class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-white dark:bg-[#0a0910ec] shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md opacity-0"> <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6"> <button data-close-modal class="ms-auto cursor-pointer rounded-full bg-black text-white px-4 py-2 dark:bg-white dark:text-black">Close</button> <div class="search-container dark:text-white"> <div id="pagefind__search"></div> </div> </div> </dialog> </site-search>   </div>  <theme-toggle class="relative h-6 w-6"> <button id="toggle-theme" class="group" aria-label="Toggle Theme"> <span class="absolute left-0 right-0 top-0 opacity-0 group-aria-pressed:opacity-100"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun-high" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z"></path> <path d="M6.343 17.657l-1.414 1.414"></path> <path d="M6.343 6.343l-1.414 -1.414"></path> <path d="M17.657 6.343l1.414 -1.414"></path> <path d="M17.657 17.657l1.414 1.414"></path> <path d="M4 12h-2"></path> <path d="M12 4v-2"></path> <path d="M20 12h2"></path> <path d="M12 20v2"></path> </svg> </span> <span class="absolute left-0 right-0 top-0 opacity-0 group-aria-[pressed=false]:opacity-100"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path> </svg> </span> </button> </theme-toggle> <script>
	const button = document.getElementById('toggle-theme')

	function setButtonPresssed() {
		const bodyThemeIsDark = document.documentElement.classList.contains('dark')
		button.setAttribute('aria-pressed', String(bodyThemeIsDark))
	}
	setButtonPresssed()
</script> <button id="astro-header-drawer-button" type="button" class="md:ml-6 md:hidden" data-astro-cid-3ef6ksr2> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M4 6l16 0"></path> <path d="M4 12l16 0"></path> <path d="M4 18l16 0"></path> </svg> <span class="sr-only" data-astro-cid-3ef6ksr2>Show Menu</span> </button> </div> </header>   <article class="min-w-full md:py-4 sm:max-w-none md:max-w-none"> <header class="mb-3 flex flex-col justify-center items-center gap-6"> <div class="flex flex-col gap-2"> <div class="flex items-center justify-center gap-x-1"> <p class="text-center text-sm text-opacity-50">
Published <time class="text-sm font-bold text-opacity-60" datetime="2025-06-08T08:00:00.000Z"> Jun 8, 2025 </time> </p> <p class="text-center text-sm text-opacity-50 font-bold">
- 10 min read </p> </div> <h1 class="text-center text-4xl md:text-6xl md:pb-2.5 font-semibold"> Encoder-Decoder Architecture: How Neural Networks Understand Sequences </h1> </div> <div class="flex flex-wrap justify-center items-center gap-2 gap-y-4 md:gap-5"> <a href="/blog/tags/encoder-decoder" aria-label="Encoder-Decoder"> <span class="bg-indigo-600 font-semibold text-white dark:bg-indigo-900 dark:text-white shadow text-sm w-fit px-2 py-1 md:px-5 md:py-2 rounded-full"> Encoder-Decoder </span> </a><a href="/blog/tags/image denoising" aria-label="Image Denoising"> <span class="bg-indigo-600 font-semibold text-white dark:bg-indigo-900 dark:text-white shadow text-sm w-fit px-2 py-1 md:px-5 md:py-2 rounded-full"> Image Denoising </span> </a> </div> </header> <img src="/_astro/banner.DYXKxOkz_UheBI.jpg" loading="eager" class="rounded-md w-full max-h-[300px]  md:max-h-[500px] my-8 object-cover" alt="img of Encoder-Decoder Architecture: How Neural Networks Understand Sequences" width="1000" height="500" decoding="async"> <hr> <div> <div class="grid grid-cols-1 md:grid-cols-[20%_auto] gap-10 mt-8" data-astro-cid-l3utfwjv><!-- aside  --><aside class="md:flex flex-col gap-8 hidden" data-astro-cid-l3utfwjv><div class="flex flex-col gap-2"> <span class="mb-1 font-bold text-2xl">Share</span> <ul class="flex gap-3 text-black dark:text-white"> <li> <a href="https://twitter.com/intent/tweet?text=Share this post https://genereux-akotenou.github.io/blog/post/auto-encoder-classic/" aria-label="Share on Twitter"><!--?xml version="1.0" ?--><svg height="32px" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M448,512l-384,0c-35.328,0 -64,-28.672 -64,-64l0,-384c0,-35.328 28.672,-64 64,-64l384,0c35.328,0 64,28.672 64,64l0,384c0,35.328 -28.672,64 -64,64Z" id="Dark_Blue" style="fill:#1da1f2;fill-rule:nonzero;"></path><path d="M196.608,386.048c120.704,0 186.752,-100.096 186.752,-186.752c0,-2.816 0,-5.632 -0.128,-8.448c12.8,-9.216 23.936,-20.864 32.768,-34.048c-11.776,5.248 -24.448,8.704 -37.76,10.368c13.568,-8.064 23.936,-20.992 28.928,-36.352c-12.672,7.552 -26.752,12.928 -41.728,15.872c-12.032,-12.8 -29.056,-20.736 -47.872,-20.736c-36.224,0 -65.664,29.44 -65.664,65.664c0,5.12 0.64,10.112 1.664,14.976c-54.528,-2.688 -102.912,-28.928 -135.296,-68.608c-5.632,9.728 -8.832,20.992 -8.832,33.024c0,22.784 11.648,42.88 29.184,54.656c-10.752,-0.384 -20.864,-3.328 -29.696,-8.192l0,0.896c0,31.744 22.656,58.368 52.608,64.384c-5.504,1.536 -11.264,2.304 -17.28,2.304c-4.224,0 -8.32,-0.384 -12.288,-1.152c8.32,26.112 32.64,45.056 61.312,45.568c-22.528,17.664 -50.816,28.16 -81.536,28.16c-5.248,0 -10.496,-0.256 -15.616,-0.896c28.928,18.432 63.488,29.312 100.48,29.312" id="Logo__x2014__FIXED" style="fill:#fff;fill-rule:nonzero;"></path></g></svg></a> </li> <li> <a href="https://www.linkedin.com/shareArticle?mini=true&#38;url=https://genereux-akotenou.github.io/blog/post/auto-encoder-classic/" aria-label="Share on LinkedIn"> <svg enable-background="new 0 0 32 32" height="32px" id="Layer_1" version="1.0" viewBox="0 0 32 32" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M32,30c0,1.104-0.896,2-2,2H2c-1.104,0-2-0.896-2-2V2c0-1.104,0.896-2,2-2h28c1.104,0,2,0.896,2,2V30z" fill="#007BB5"></path><g><rect fill="#FFFFFF" height="14" width="4" x="7" y="11"></rect><path d="M20.499,11c-2.791,0-3.271,1.018-3.499,2v-2h-4v14h4v-8c0-1.297,0.703-2,2-2c1.266,0,2,0.688,2,2v8h4v-7    C25,14,24.479,11,20.499,11z" fill="#FFFFFF"></path><circle cx="9" cy="8" fill="#FFFFFF" r="2"></circle></g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></a> </li> </ul> </div><!--<a href="#disqus_thread">Link</a>--><div class="sticky top-24 self-start hidden md:block transition-all duration-200" data-astro-cid-l3utfwjv><nav class="max-w-xs dark:text-black"> <h1 class="font-bold mb-3 text-2xl dark:text-white">Index</h1> <ul class="[text-wrap:balance] flex flex-col gap-1"> <li class="flex flex-col"> <a href="#introduction" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Introduction </a>  </li><li class="flex flex-col"> <a href="#denoising-autoencoder" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Denoising Autoencoder </a>  </li><li class="flex flex-col"> <a href="#how-the-autoencoder-sees" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> How the Autoencoder Sees </a>  </li><li class="flex flex-col"> <a href="#import-utils" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Import Utils </a>  </li><li class="flex flex-col"> <a href="#dataset" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Dataset: </a>  </li><li class="flex flex-col"> <a href="#model" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Model </a>  </li><li class="flex flex-col"> <a href="#trainer" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Trainer </a>  </li><li class="flex flex-col"> <a href="#results-analysis" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Results Analysis </a>  </li> </ul> </nav></div></aside><!-- post --><article class="max-w-full w-full" data-astro-cid-l3utfwjv><div style_="transform: scale(0.9); transform-origin: top;" data-astro-cid-l3utfwjv><div class="prose prose-lg md:prose-xl dark:prose-invert mb-12 min-w-full" data-astro-cid-l3utfwjv><h2 id="introduction">Introduction</h2>
<p>Autoencoders are a fascinating class of neural networks. At their core, they aim to learn efficient data representationsâ€”compressing information through an encoder and then reconstructing it with a decoder. What makes them even more compelling is their ability to learn these representations without supervision. In practice, this makes them excellent tools for applications such as image denoising, anomaly detection, and dimensionality reduction.</p>
<p>In this blog, we explore how a denoising autoencoder can clean up noisy grayscale images. The model learns to filter out visual noise by comparing noisy input images with their clean originals and training itself to minimize the gap between the two. The task is deceptively simple: feed the model a corrupted image, and ask it to predict what the clean version would look like. But the underlying mechanisms are what make this process powerful.</p>
<h2 id="denoising-autoencoder">Denoising Autoencoder</h2>
<p>The goal of this task is to train a <strong>Denoising Autoencoder</strong> using a small dataset of grayscale natural images. An autoencoder is a type of neural network that learns to compress and reconstruct input data. It consists of an encoder that compresses the data into a lower-dimensional representation, and a decoder that reconstructs the original data from the compressed representation as illustrated by the image 1</p>
<p><img alt="Encoder-decoder"  src="/_astro/autoenc.33D1vg0y_auIAS.webp" width="1442" height="582" loading="lazy" decoding="async"><br>
<strong>Image 1: Denoising Autoencoder Architecture <a href="https://lilianweng.github.io/posts/2018-08-12-vae/" target="_blank">(source)</a></strong></p>
<h2 id="how-the-autoencoder-sees">How the Autoencoder Sees</h2>
<p>We begin by preparing a dataset of natural grayscale images. Each image, originally from CIFAR-10, is resized to 64x64 pixels and converted to a single channel. To make things harder for our model, we add Gaussian noise to every image. The noise levels are chosen carefully, ranging from severe to subtle. The goal is to find a level where the images are visibly corrupted, but still preserve enough structure for the model to reconstruct them meaningfully. Once the data is ready, we construct the model. The encoder compresses the input image through a series of convolutional layers followed by a linear bottleneck. This bottleneck captures the essential visual features while discarding irrelevant details like random noise. The decoder then attempts to recreate the original image by inverting the encoderâ€™s operations. It gradually upsamples the compressed representation through transposed convolutions, with a sigmoid activation at the output to map the pixel values back into the 0 to 1 range.</p>
<p><strong>Encoder</strong>
To implement our autoencoder to denoise images, we will first implement the encoder, which is responsible for transforming the input images into a compressed representation in the latent space. It consists of a series of convolutional and fully connected layers. This compressed representation contains essential features of the input images that capture their underlying patterns and structures and will help the encoder learn to preserve as much of the relevant information as possible within the limitations of the latent space, and cleverly discard irrelevant parts like noise. We will use the <strong>ReLU</strong> activation function in the encoder to introduce non-linearity, allowing the network to learn complex representations and extract important features from the input data.</p>
<p><strong>Decoder</strong>
The decoder layer is responsible for reconstructing the images from the compressed representation in the latent space.
It mirrors the structure of the encoder and consists of a series of fully connected and transpose convolutional layers. We will use <strong>Sigmoid</strong> and <strong>ReLU</strong> activations in the decoder layer. The goal of using sigmoid in the decoder is to produce reconstructed output values in the range [0, 1]. Since the input data in this task represents binary images, sigmoid is a suitable activation function for reconstructing pixel values. We choose sigmoid here because the problem we are dealing with grayscale images.</p>
<p><strong>Training</strong>
For this denoising task, we choose <strong>Mean Squared Error</strong> as the loss function and <strong>Adam</strong> as the optimizer. MSELoss is well-suited for image reconstruction problems involving continuous-valued grayscale images, where each pixel has a value in the range [0, 1]. Unlike Binary Cross-Entropy (BCE), which is typically used for binary classification tasks or binary pixel outputs (0 or 1), MSE penalizes the average squared difference between the predicted and target pixel values â€” making it more appropriate when pixel intensities can vary smoothly. We also use the <strong>Adam optimizer</strong>, which provides adaptive learning rates for each parameter and generally leads to faster convergence compared to SGD in deep learning tasks.</p>
<p>Now that we have a clear idea, letâ€™s start with the code.</p>
<h2 id="import-utils">Import Utils</h2>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> torch</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> glob</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> random</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> torch</span><span style="color:#89DDFF">.</span><span style="color:#F07178">nn</span><span style="color:#89DDFF;font-style:italic"> as</span><span style="color:#BABED8"> nn</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> torch</span><span style="color:#89DDFF">.</span><span style="color:#F07178">optim</span><span style="color:#89DDFF;font-style:italic"> as</span><span style="color:#BABED8"> optim</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> torchvision</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> torch</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">utils</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">data </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> DataLoader</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> random_split</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> TensorDataset</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> Subset</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> torchvision </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> datasets</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> transforms</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> matplotlib</span><span style="color:#89DDFF">.</span><span style="color:#F07178">pyplot</span><span style="color:#89DDFF;font-style:italic"> as</span><span style="color:#BABED8"> plt</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> pathlib </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> Path</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> PIL </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> Image</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> pandas </span><span style="color:#89DDFF;font-style:italic">as</span><span style="color:#BABED8"> pd</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> numpy </span><span style="color:#89DDFF;font-style:italic">as</span><span style="color:#BABED8"> np</span></span></code></pre>
<p><strong>Letâ€™s implementent some helper functions</strong></p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#C792EA">class</span><span style="color:#FFCB6B"> Helper</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#89DDFF">    @</span><span style="color:#FFCB6B">staticmethod</span></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> add_gaussian_noise</span><span style="color:#89DDFF">(</span><span style="color:#BABED8;font-style:italic">images</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> noise_level</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">0.2</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> mean</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">0.0</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        """</span></span>
<span class="line"><span style="color:#676E95;font-style:italic">        Adds visually balanced Gaussian noise to images.</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        """</span></span>
<span class="line"><span style="color:#BABED8">        std </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> noise_level</span></span>
<span class="line"><span style="color:#BABED8">        noise </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> torch</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">randn_like</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">images</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> *</span><span style="color:#BABED8"> std </span><span style="color:#89DDFF">+</span><span style="color:#BABED8"> mean</span></span>
<span class="line"><span style="color:#BABED8">        noisy_images </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> images </span><span style="color:#89DDFF">+</span><span style="color:#BABED8"> noise</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        return</span><span style="color:#BABED8"> torch</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">clamp</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">noisy_images</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">.,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">.)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF">    @</span><span style="color:#FFCB6B">staticmethod</span></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> show_images</span><span style="color:#89DDFF">(</span><span style="color:#BABED8;font-style:italic">original</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> noisy</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> reconstructed</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> n</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">5</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> title</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">Denoising Results</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        """</span></span>
<span class="line"><span style="color:#676E95;font-style:italic">        Display original, noisy, and reconstructed images side by side.</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        """</span></span>
<span class="line"><span style="color:#BABED8">        fig</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> axes </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> plt</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">subplots</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">n</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> figsize</span><span style="color:#89DDFF">=(</span><span style="color:#F78C6C">10</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF"> *</span><span style="color:#82AAFF"> n</span><span style="color:#89DDFF">))</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        if</span><span style="color:#BABED8"> n </span><span style="color:#89DDFF">==</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#BABED8">            axes </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> axes</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">reshape</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 3</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        for</span><span style="color:#BABED8"> i </span><span style="color:#89DDFF;font-style:italic">in</span><span style="color:#82AAFF"> range</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">n</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#BABED8">            axes</span><span style="color:#89DDFF">[</span><span style="color:#BABED8">i</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">imshow</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">original</span><span style="color:#89DDFF">[</span><span style="color:#82AAFF">i</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">squeeze</span><span style="color:#89DDFF">().</span><span style="color:#82AAFF">cpu</span><span style="color:#89DDFF">(),</span><span style="color:#BABED8;font-style:italic"> cmap</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">gray</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">            axes</span><span style="color:#89DDFF">[</span><span style="color:#BABED8">i</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 0</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">set_title</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Original</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">            axes</span><span style="color:#89DDFF">[</span><span style="color:#BABED8">i</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">imshow</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">noisy</span><span style="color:#89DDFF">[</span><span style="color:#82AAFF">i</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">squeeze</span><span style="color:#89DDFF">().</span><span style="color:#82AAFF">cpu</span><span style="color:#89DDFF">(),</span><span style="color:#BABED8;font-style:italic"> cmap</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">gray</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">            axes</span><span style="color:#89DDFF">[</span><span style="color:#BABED8">i</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">set_title</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Noisy</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">            axes</span><span style="color:#89DDFF">[</span><span style="color:#BABED8">i</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 2</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">imshow</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">reconstructed</span><span style="color:#89DDFF">[</span><span style="color:#82AAFF">i</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">detach</span><span style="color:#89DDFF">().</span><span style="color:#82AAFF">squeeze</span><span style="color:#89DDFF">().</span><span style="color:#82AAFF">cpu</span><span style="color:#89DDFF">(),</span><span style="color:#BABED8;font-style:italic"> cmap</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">gray</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">            axes</span><span style="color:#89DDFF">[</span><span style="color:#BABED8">i</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 2</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">set_title</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Reconstructed</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">            for</span><span style="color:#BABED8"> j </span><span style="color:#89DDFF;font-style:italic">in</span><span style="color:#82AAFF"> range</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#BABED8">                axes</span><span style="color:#89DDFF">[</span><span style="color:#BABED8">i</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> j</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">axis</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">off</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">        plt</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">suptitle</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">title</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">        plt</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">tight_layout</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#BABED8">        plt</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">show</span><span style="color:#89DDFF">()</span></span></code></pre>
<h2 id="dataset">Dataset:</h2>
<p>Load â†’ Transform â†’ Train-Test Split</p>
<p>For this assignment, we chose the CIFAR-10 dataset. Since the original images are 32Ã—32 in resolution, we first resize them to 64Ã—64 to match the task requirements and convert them to grayscale. We then take a sample of 100 images and split them into training and testing sets using the classic 80/20 split to ensure separation between the two. Finally, we prepare the corresponding data loaders for training and testing.</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic"># We apply this base transform to keep all images 64x64 and convert them to 64x64</span></span>
<span class="line"><span style="color:#BABED8">base_transform </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> transforms</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Compose</span><span style="color:#89DDFF">([</span></span>
<span class="line"><span style="color:#82AAFF">    transforms</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Resize</span><span style="color:#89DDFF">((</span><span style="color:#F78C6C">64</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 64</span><span style="color:#89DDFF">)),</span></span>
<span class="line"><span style="color:#82AAFF">    transforms</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Grayscale</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#89DDFF">])</span></span>
<span class="line"><span style="color:#676E95;font-style:italic"># As we have to work with 100 images only we will augment the dataset</span></span>
<span class="line"><span style="color:#BABED8">augmentation_transform </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> transforms</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Compose</span><span style="color:#89DDFF">([</span></span>
<span class="line"><span style="color:#82AAFF">    transforms</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">RandomHorizontalFlip</span><span style="color:#89DDFF">(),</span><span style="color:#82AAFF">                </span></span>
<span class="line"><span style="color:#82AAFF">    transforms</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">RandomVerticalFlip</span><span style="color:#89DDFF">(),</span><span style="color:#82AAFF"> </span></span>
<span class="line"><span style="color:#82AAFF">    transforms</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">RandomResizedCrop</span><span style="color:#89DDFF">(</span><span style="color:#BABED8;font-style:italic">size</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">64</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> scale</span><span style="color:#89DDFF">=(</span><span style="color:#F78C6C">0.9</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 1.0</span><span style="color:#89DDFF">)),</span></span>
<span class="line"><span style="color:#82AAFF">    transforms</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">ColorJitter</span><span style="color:#89DDFF">(</span><span style="color:#BABED8;font-style:italic">brightness</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">0.1</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> contrast</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">0.1</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">])</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic"># We load and select 100 images</span></span>
<span class="line"><span style="color:#BABED8">raw_dataset </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> torchvision</span><span style="color:#89DDFF">.</span><span style="color:#F07178">datasets</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">CIFAR10</span><span style="color:#89DDFF">(</span><span style="color:#BABED8;font-style:italic">root</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">./data</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> train</span><span style="color:#89DDFF">=True,</span><span style="color:#BABED8;font-style:italic"> download</span><span style="color:#89DDFF">=True)</span></span>
<span class="line"><span style="color:#BABED8">subset</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> _ </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> random_split</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">raw_dataset</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> [</span><span style="color:#F78C6C">100</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> len</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">raw_dataset</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> -</span><span style="color:#F78C6C"> 100</span><span style="color:#89DDFF">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic"># Offline augmentation, original + n augmentations</span></span>
<span class="line"><span style="color:#BABED8">augmented_images </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> []</span></span>
<span class="line"><span style="color:#BABED8">n_augment </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 10</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">for</span><span style="color:#BABED8"> img</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> _ </span><span style="color:#89DDFF;font-style:italic">in</span><span style="color:#BABED8"> subset</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#BABED8">    base </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> base_transform</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">img</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">    base_tensor </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> transforms</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">ToTensor</span><span style="color:#89DDFF">()(</span><span style="color:#82AAFF">base</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">    augmented_images</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">append</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">base_tensor</span><span style="color:#89DDFF">)</span><span style="color:#BABED8"> </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    for</span><span style="color:#BABED8"> _ </span><span style="color:#89DDFF;font-style:italic">in</span><span style="color:#82AAFF"> range</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">n_augment</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#BABED8">        aug_img </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> augmentation_transform</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">base</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">        aug_tensor </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> transforms</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">ToTensor</span><span style="color:#89DDFF">()(</span><span style="color:#82AAFF">aug_img</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">        augmented_images</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">append</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">aug_tensor</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic"># We create the dataset and do train-test split</span></span>
<span class="line"><span style="color:#BABED8">all_data </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> torch</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">stack</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">augmented_images</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">dataset </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> TensorDataset</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">all_data</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">train_set</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> test_set </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> random_split</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">dataset</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> [</span><span style="color:#FFCB6B">int</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">0.8</span><span style="color:#89DDFF"> *</span><span style="color:#82AAFF"> len</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">dataset</span><span style="color:#89DDFF">)),</span><span style="color:#82AAFF"> len</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">dataset</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> -</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">0.8</span><span style="color:#89DDFF"> *</span><span style="color:#82AAFF"> len</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">dataset</span><span style="color:#89DDFF">))])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic"># We finally prepare dataloader for trainer</span></span>
<span class="line"><span style="color:#BABED8">train_loader </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> DataLoader</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">train_set</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> batch_size</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">64</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> shuffle</span><span style="color:#89DDFF">=True)</span></span>
<span class="line"><span style="color:#BABED8">test_loader </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> DataLoader</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">test_set</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> batch_size</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">64</span><span style="color:#89DDFF">)</span></span></code></pre>
<p><strong>Noise Level</strong></p>
<p>To determine a suitable noise level for training the denoising autoencoder, we conduct several manual tests. The goal is to identify a noise intensity that ensures the added noise is clearly visible in the images, while still preserving enough of the original content for meaningful reconstruction. This balance is essential: the noise should be strong enough to challenge the model, but not so extreme that the underlying structure of the image is lost.</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic"># Let test our noise function</span></span>
<span class="line"><span style="color:#BABED8">idx </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 737</span><span style="color:#676E95;font-style:italic">#random.randint(0, len(dataset) - 1)</span></span>
<span class="line"><span style="color:#BABED8">original_img </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> dataset</span><span style="color:#89DDFF">[</span><span style="color:#BABED8">idx</span><span style="color:#89DDFF">][</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">]</span></span>
<span class="line"><span style="color:#BABED8">original_batch </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> original_img</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">unsqueeze</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">reconstructed_batch </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> torch</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">zeros</span><span style="color:#89DDFF">(</span><span style="color:#BABED8;font-style:italic">size</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">original_batch</span><span style="color:#89DDFF">.</span><span style="color:#F07178">shape</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8">noisy_batch </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> Helper</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">add_gaussian_noise</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">original_batch</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> noise_level</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">0.5</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">Helper</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">show_images</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">original_batch</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> noisy_batch</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> reconstructed_batch</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> n</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> title</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Original vs Noisy (Random Sample)</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span></code></pre>
<p><img alt="Encoder-decoder"  src="/_astro/01.DHaieX_K_1gnvXV.webp" width="1796" height="608" loading="lazy" decoding="async"></p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">noisy_batch </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> Helper</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">add_gaussian_noise</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">original_batch</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> noise_level</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">0.2</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">Helper</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">show_images</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">original_batch</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> noisy_batch</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> reconstructed_batch</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> n</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> title</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Original vs Noisy (Random Sample)</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span></code></pre>
<p><img alt="Encoder-decoder"  src="/_astro/02.CZGEeRXw_ZpbsQY.webp" width="1796" height="608" loading="lazy" decoding="async"></p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">noisy_batch </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> Helper</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">add_gaussian_noise</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">original_batch</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> noise_level</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">0.1</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">Helper</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">show_images</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">original_batch</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> noisy_batch</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> reconstructed_batch</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> n</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> title</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Original vs Noisy (Random Sample)</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span></code></pre>
<p><img alt="Encoder-decoder"  src="/_astro/03.CknYS5Wv_24p3We.webp" width="1796" height="608" loading="lazy" decoding="async"></p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">noisy_batch </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> Helper</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">add_gaussian_noise</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">original_batch</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> noise_level</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">0.03</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">Helper</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">show_images</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">original_batch</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> noisy_batch</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> reconstructed_batch</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> n</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> title</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Original vs Noisy (Random Sample)</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span></code></pre>
<p><img alt="Encoder-decoder"  src="/_astro/04.BJFJE4Xe_2piDpo.webp" width="1796" height="608" loading="lazy" decoding="async"></p>
<p>Conclusion: For our experiement we will use <code>noise_level=0.3</code></p>
<h2 id="model">Model</h2>
<p>DenoisingAutoencoder uses a convolutional encoder-decoder architecture with a fully connected latent bottleneck layer. The encoder compresses a 64x64 grayscale image into a low-dimensional latent vector (default size: 128), and the decoder reconstructs the image from this latent space. ReLU and Sigmoid activations help learn non-linear representations and normalize output pixel values.</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#C792EA">class</span><span style="color:#FFCB6B"> DenoisingAutoencoder</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">nn</span><span style="color:#89DDFF">.</span><span style="color:#FFCB6B">Module</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> __init__</span><span style="color:#89DDFF">(</span><span style="color:#F07178;font-style:italic">self</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> input_channels</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> latent_dim</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">128</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#FFCB6B">        super</span><span style="color:#89DDFF">().</span><span style="color:#82AAFF">__init__</span><span style="color:#89DDFF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">encoder</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Sequential</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#82AAFF">            nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Conv2d</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">input_channels</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 32</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> kernel_size</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> stride</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> padding</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">),</span></span>
<span class="line"><span style="color:#82AAFF">            nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">ReLU</span><span style="color:#89DDFF">(),</span></span>
<span class="line"><span style="color:#82AAFF">            nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Conv2d</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">32</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 64</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> kernel_size</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> stride</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> padding</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">),</span><span style="color:#82AAFF">              </span></span>
<span class="line"><span style="color:#82AAFF">            nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">ReLU</span><span style="color:#89DDFF">(),</span></span>
<span class="line"><span style="color:#82AAFF">            nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Conv2d</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">64</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 128</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> kernel_size</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> stride</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> padding</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">),</span><span style="color:#82AAFF">    </span></span>
<span class="line"><span style="color:#82AAFF">            nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">ReLU</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#89DDFF">        )</span></span>
<span class="line"><span style="color:#BABED8">        </span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">flatten</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Flatten</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">latent</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Linear</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">128</span><span style="color:#89DDFF"> *</span><span style="color:#F78C6C"> 8</span><span style="color:#89DDFF"> *</span><span style="color:#F78C6C"> 8</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> latent_dim</span><span style="color:#89DDFF">)</span><span style="color:#BABED8">  </span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">unlatent</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Linear</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">latent_dim</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 128</span><span style="color:#89DDFF"> *</span><span style="color:#F78C6C"> 8</span><span style="color:#89DDFF"> *</span><span style="color:#F78C6C"> 8</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">unflatten</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Unflatten</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#89DDFF"> (</span><span style="color:#F78C6C">128</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 8</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 8</span><span style="color:#89DDFF">))</span><span style="color:#BABED8">   </span></span>
<span class="line"><span style="color:#BABED8">        </span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">decoder</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Sequential</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#82AAFF">            nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">ConvTranspose2d</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">128</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 64</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> kernel_size</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> stride</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> padding</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> output_padding</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">),</span><span style="color:#82AAFF"> </span></span>
<span class="line"><span style="color:#82AAFF">            nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">ReLU</span><span style="color:#89DDFF">(),</span></span>
<span class="line"><span style="color:#82AAFF">            nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">ConvTranspose2d</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">64</span><span style="color:#89DDFF">,</span><span style="color:#F78C6C"> 32</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> kernel_size</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> stride</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> padding</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> output_padding</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">),</span><span style="color:#82AAFF"> </span></span>
<span class="line"><span style="color:#82AAFF">            nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">ReLU</span><span style="color:#89DDFF">(),</span></span>
<span class="line"><span style="color:#82AAFF">            nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">ConvTranspose2d</span><span style="color:#89DDFF">(</span><span style="color:#F78C6C">32</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> input_channels</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> kernel_size</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">3</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> stride</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> padding</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> output_padding</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1</span><span style="color:#89DDFF">),</span><span style="color:#82AAFF"> </span></span>
<span class="line"><span style="color:#82AAFF">            nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">Sigmoid</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#89DDFF">        )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> forward</span><span style="color:#89DDFF">(</span><span style="color:#F07178;font-style:italic">self</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> x</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#BABED8">        x </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">encoder</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span><span style="color:#BABED8">                  </span></span>
<span class="line"><span style="color:#BABED8">        x </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">flatten</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span><span style="color:#BABED8">             </span></span>
<span class="line"><span style="color:#BABED8">        x </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">latent</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span><span style="color:#BABED8">                    </span></span>
<span class="line"><span style="color:#BABED8">        x </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">unlatent</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span><span style="color:#BABED8">            </span></span>
<span class="line"><span style="color:#BABED8">        x </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">unflatten</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span><span style="color:#BABED8">                </span></span>
<span class="line"><span style="color:#BABED8">        y </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">decoder</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">x</span><span style="color:#89DDFF">)</span><span style="color:#BABED8">                  </span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        return</span><span style="color:#BABED8"> y</span></span></code></pre>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">model </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> DenoisingAutoencoder</span><span style="color:#89DDFF">()</span></span></code></pre>
<h2 id="trainer">Trainer</h2>
<p>This class manages training and evaluation of the denoising autoencoder model. It includes a compile step to define the loss and optimizer, and supports Gaussian noise injection, loss tracking, and optional early stopping.</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#C792EA">class</span><span style="color:#FFCB6B"> Trainer</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> __init__</span><span style="color:#89DDFF">(</span><span style="color:#F07178;font-style:italic">self</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> model</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> train_loader</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> test_loader</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> noise_fn</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> noise_level</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> device</span><span style="color:#89DDFF">=None,</span><span style="color:#BABED8;font-style:italic"> verbose</span><span style="color:#89DDFF">=True):</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">device</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> device </span><span style="color:#89DDFF">or</span><span style="color:#BABED8"> torch</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">device</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">cuda</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF;font-style:italic"> if</span><span style="color:#82AAFF"> torch</span><span style="color:#89DDFF">.</span><span style="color:#F07178">cuda</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">is_available</span><span style="color:#89DDFF">()</span><span style="color:#89DDFF;font-style:italic"> else</span><span style="color:#89DDFF"> '</span><span style="color:#C3E88D">cpu</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">model</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> model</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">to</span><span style="color:#89DDFF">(</span><span style="color:#BABED8">self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">device</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">train_loader</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> train_loader</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">test_loader</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> test_loader</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">noise_fn</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> noise_fn</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">noise_level</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> noise_level</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">verbose</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> verbose</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">criterion</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> None</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">optimizer</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> None</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">train_losses</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> []</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">test_losses</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> compile</span><span style="color:#89DDFF">(</span><span style="color:#F07178;font-style:italic">self</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> loss_fn</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> optimizer_class</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> lr</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">0.001</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        """</span></span>
<span class="line"><span style="color:#676E95;font-style:italic">        Mimics Keras-style compile method to define loss and optimizer.</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        """</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">criterion</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> loss_fn</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">optimizer</span><span style="color:#89DDFF"> =</span><span style="color:#82AAFF"> optimizer_class</span><span style="color:#89DDFF">(</span><span style="color:#BABED8">self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">model</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">parameters</span><span style="color:#89DDFF">(),</span><span style="color:#BABED8;font-style:italic"> lr</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">lr</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> train</span><span style="color:#89DDFF">(</span><span style="color:#F07178;font-style:italic">self</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> num_epochs</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">20</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> early_stopping_patience</span><span style="color:#89DDFF">=None):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        """</span></span>
<span class="line"><span style="color:#676E95;font-style:italic">        Trains the model, with optional early stopping.</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        """</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        if</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">criterion</span><span style="color:#89DDFF"> is</span><span style="color:#89DDFF"> None</span><span style="color:#89DDFF"> or</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">optimizer</span><span style="color:#89DDFF"> is</span><span style="color:#89DDFF"> None:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">            raise</span><span style="color:#FFCB6B"> ValueError</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">You must call compile() before training.</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8">        best_loss </span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B"> float</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">inf</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">        patience_counter </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        for</span><span style="color:#BABED8"> epoch </span><span style="color:#89DDFF;font-style:italic">in</span><span style="color:#82AAFF"> range</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">num_epochs</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#BABED8">            self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">model</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">train</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#BABED8">            running_loss </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 0.0</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">            for</span><span style="color:#BABED8"> inputs </span><span style="color:#89DDFF;font-style:italic">in</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">train_loader</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#BABED8">                inputs </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> inputs</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">to</span><span style="color:#89DDFF">(</span><span style="color:#BABED8">self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">device</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">                noisy_inputs </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">noise_fn</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">inputs</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">noise_level</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">                outputs </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">model</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">noisy_inputs</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">                loss </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">criterion</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">outputs</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> inputs</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8">                self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">optimizer</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">zero_grad</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#BABED8">                loss</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">backward</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#BABED8">                self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">optimizer</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">step</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#BABED8">                running_loss </span><span style="color:#89DDFF">+=</span><span style="color:#BABED8"> loss</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">item</span><span style="color:#89DDFF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8">            epoch_train_loss </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> running_loss </span><span style="color:#89DDFF">/</span><span style="color:#82AAFF"> len</span><span style="color:#89DDFF">(</span><span style="color:#BABED8">self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">train_loader</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">            self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">train_losses</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">append</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">epoch_train_loss</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic">            # evaluation</span></span>
<span class="line"><span style="color:#BABED8">            self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">model</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">eval</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#BABED8">            running_test_loss </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 0.0</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">            with</span><span style="color:#BABED8"> torch</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">no_grad</span><span style="color:#89DDFF">():</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">                for</span><span style="color:#BABED8"> inputs </span><span style="color:#89DDFF;font-style:italic">in</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">test_loader</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#BABED8">                    inputs </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> inputs</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">to</span><span style="color:#89DDFF">(</span><span style="color:#BABED8">self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">device</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">                    noisy_inputs </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">noise_fn</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">inputs</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">noise_level</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">                    outputs </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">model</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">noisy_inputs</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">                    loss </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">criterion</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">outputs</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> inputs</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">                    running_test_loss </span><span style="color:#89DDFF">+=</span><span style="color:#BABED8"> loss</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">item</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#BABED8">            epoch_test_loss </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> running_test_loss </span><span style="color:#89DDFF">/</span><span style="color:#82AAFF"> len</span><span style="color:#89DDFF">(</span><span style="color:#BABED8">self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">test_loader</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">            self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">test_losses</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">append</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">epoch_test_loss</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">            if</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">verbose</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#82AAFF">                print</span><span style="color:#89DDFF">(</span><span style="color:#C792EA">f</span><span style="color:#C3E88D">"Epoch </span><span style="color:#F78C6C">{</span><span style="color:#82AAFF">epoch</span><span style="color:#89DDFF">+</span><span style="color:#F78C6C">1}</span><span style="color:#C3E88D">: Train Loss = </span><span style="color:#F78C6C">{</span><span style="color:#82AAFF">epoch_train_loss</span><span style="color:#C792EA">:.4f</span><span style="color:#F78C6C">}</span><span style="color:#C3E88D">, Test Loss = </span><span style="color:#F78C6C">{</span><span style="color:#82AAFF">epoch_test_loss</span><span style="color:#C792EA">:.4f</span><span style="color:#F78C6C">}</span><span style="color:#C3E88D">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic">            # early stopping check</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">            if</span><span style="color:#BABED8"> early_stopping_patience </span><span style="color:#89DDFF">is</span><span style="color:#89DDFF"> not</span><span style="color:#89DDFF"> None:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">                if</span><span style="color:#BABED8"> epoch_test_loss </span><span style="color:#89DDFF">&#x3C;</span><span style="color:#BABED8"> best_loss</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#BABED8">                    best_loss </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> epoch_test_loss</span></span>
<span class="line"><span style="color:#BABED8">                    patience_counter </span><span style="color:#89DDFF">=</span><span style="color:#F78C6C"> 0</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">                else</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#BABED8">                    patience_counter </span><span style="color:#89DDFF">+=</span><span style="color:#F78C6C"> 1</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">                    if</span><span style="color:#BABED8"> patience_counter </span><span style="color:#89DDFF">>=</span><span style="color:#BABED8"> early_stopping_patience</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#82AAFF">                        print</span><span style="color:#89DDFF">(</span><span style="color:#C792EA">f</span><span style="color:#C3E88D">"Early stopping triggered at epoch </span><span style="color:#F78C6C">{</span><span style="color:#82AAFF">epoch</span><span style="color:#89DDFF">+</span><span style="color:#F78C6C">1}</span><span style="color:#C3E88D">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">                        break</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> get_losses</span><span style="color:#89DDFF">(</span><span style="color:#F07178;font-style:italic">self</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        return</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">train_losses</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">test_losses</span></span></code></pre>
<p><strong>Run training</strong></p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">trainer </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> Trainer</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#82AAFF">    model</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> </span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    train_loader</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">train_loader</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> </span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    test_loader</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">test_loader</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> </span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    noise_fn</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">Helper</span><span style="color:#89DDFF">.</span><span style="color:#F07178">add_gaussian_noise</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    noise_level</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">0.03</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    verbose</span><span style="color:#89DDFF">=False</span></span>
<span class="line"><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">trainer</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">compile</span><span style="color:#89DDFF">(</span><span style="color:#BABED8;font-style:italic">loss_fn</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">nn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">MSELoss</span><span style="color:#89DDFF">(),</span><span style="color:#BABED8;font-style:italic"> optimizer_class</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">optim</span><span style="color:#89DDFF">.</span><span style="color:#F07178">Adam</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> lr</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">0.001</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">trainer</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">train</span><span style="color:#89DDFF">(</span><span style="color:#BABED8;font-style:italic">num_epochs</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">200</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> early_stopping_patience</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">10</span><span style="color:#89DDFF">)</span></span></code></pre>
<p>Early stopping triggered at epoch 98</p>
<h2 id="results-analysis">Results Analysis</h2>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">plt</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">plot</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">train_losses</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> label</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Train Loss</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">plt</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">plot</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">test_losses</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> label</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Test Loss</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">plt</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">xlabel</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Epoch</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">plt</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">ylabel</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Loss</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">plt</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">title</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Training vs Test Loss</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">plt</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">legend</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#BABED8">plt</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">show</span><span style="color:#89DDFF">()</span></span></code></pre>
<p><img alt="Encoder-decoder"  src="/_astro/loss.upnGVddP_ZSMiHv.webp" width="1224" height="884" loading="lazy" decoding="async"></p>
<p>Letâ€™s visualize a few reconstructions</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">device </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> torch</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">device</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">cuda</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF;font-style:italic"> if</span><span style="color:#82AAFF"> torch</span><span style="color:#89DDFF">.</span><span style="color:#F07178">cuda</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">is_available</span><span style="color:#89DDFF">()</span><span style="color:#89DDFF;font-style:italic"> else</span><span style="color:#89DDFF"> '</span><span style="color:#C3E88D">cpu</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">inputs </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> next</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">iter</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">test_loader</span><span style="color:#89DDFF">))</span></span>
<span class="line"><span style="color:#BABED8">inputs </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> inputs</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">to</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">device</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">noisy_inputs </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> Helper</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">add_gaussian_noise</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">inputs</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> noise_level</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">0.03</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">outputs </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> model</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">noisy_inputs</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">Helper</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">show_images</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">inputs</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">cpu</span><span style="color:#89DDFF">(),</span><span style="color:#82AAFF"> noisy_inputs</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">cpu</span><span style="color:#89DDFF">(),</span><span style="color:#82AAFF"> outputs</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">cpu</span><span style="color:#89DDFF">(),</span><span style="color:#BABED8;font-style:italic"> n</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">5</span><span style="color:#89DDFF">)</span></span></code></pre>
<p><img alt="Encoder-decoder"  src="/_astro/res-1.CrVSWhWp_Z1lhaXc.webp" width="1848" height="1178" loading="lazy" decoding="async">
<img alt="Encoder-decoder"  src="/_astro/res-2.DZirzWQE_Z1ztqEG.webp" width="1848" height="586" loading="lazy" decoding="async">
<img alt="Encoder-decoder"  src="/_astro/res-3.CpHWDYDI_kuFm9.webp" width="1848" height="1178" loading="lazy" decoding="async"></p>
<p><strong>Conclusion:</strong>
The reconstruction results in the image indicate that the denoising autoencoder performs well in removing noise and restoring the essential structure of the input images. The training and validation loss curves both show a consistent downward trend and convergence, suggesting effective learning without overfitting. Visually, the reconstructed images closely resemble the original ones, especially in preserving overall shapes and edges, although some fine details appear slightly blurred. This blurriness is a common artifact of autoencoders trained with pixel-wise loss functions like MSE, which tend to favor smooth outputs over sharp, detailed reconstructions. Overall, the model generalizes effectively to noisy inputs, capturing the key visual patterns necessary for denoising while showing minor limitations in recovering high-frequency details.</p></div><!-- related posts --><!--<div id="disqus_thread"></div>
			<script>
				/**
				*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
				*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
				/*
				var disqus_config = function () {
				this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
				this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
				};
				*/
				(function() { // DON'T EDIT BELOW THIS LINE
				var d = document, s = d.createElement('script');
				s.src = 'https://genereux-akotenou.disqus.com/embed.js';
				s.setAttribute('data-timestamp', +new Date());
				(d.head || d.body).appendChild(s);
				})();
			</script>
			<script id="dsq-count-scr" src="//genereux-akotenou.disqus.com/count.js" async></script>--><footer data-astro-cid-l3utfwjv><h2 class="font-bold text-lg dark:text-white mb-6" data-astro-cid-l3utfwjv>Related Posts</h2><section class="flex flex-col md:flex-row sm:justify-between gap-8"> <div class="flex flex-wrap gap-2"> <div class="min-h-full"> <img src="/_astro/transformers.X6JrYr8Z_Z1Ovp34.webp" class="w-16 h-16 object-cover rounded-full  " alt="img of Transformers: The Revolutionary Architecture Powering Modern AI" width="200" height="200" loading="lazy" decoding="async"> </div> <header class="flex justify-center items-center"> <a class="font-medium  hover:underline" href="/blog/post/transformers/"> Transformers: The Revolutionary Architecture Powering Modern AI </a> </header> </div> </section></footer><div class="mx-auto max-w-3x- pt-8 md:pt-4 pb-12 md:pb-20" data-astro-cid-r2x3s5wt> <div id="disqus_thread" style="background: #e2e8f0; padding: 1em; border-radius: 0.7em;" data-astro-cid-r2x3s5wt></div> <script>(function(){const shortname = "genereux-akotenou";

		var d = document,
			s = d.createElement('script')
		s.src = 'https://' + shortname + '.disqus.com/embed.js'
		s.setAttribute('data-timestamp', String(new Date()))
		s.setAttribute('data-theme', localStorage.getItem('theme') ?? 'light') // Pass the string value directly
		;(d.head || d.body).appendChild(s)

		// document.addEventListener('theme-change', (e) => {
		//   todo: reload disqus
		// })
	})();</script> </div></div></article></div> </div> </article>  <footer class="flex justify-center items-center w-full px-16 h-28 border-t-2">
&copy; 2025 GÃ©nÃ©reux Akotenou -&nbsp; All rights reserved.
</footer> <!-- <a href="mailto:mahouzonssou.akotenou@um6p.ma">mahouzonssou.akotenou@um6p.ma</a> &nbsp; --> </main>    </body> </html> 