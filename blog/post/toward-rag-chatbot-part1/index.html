<!DOCTYPE html><html lang="en" class="scroll-smooth" data-astro-cid-37fxchfa> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.0.8"><!-- Canonical URL --><link rel="canonical" href="https://genereux-akotenou.github.io/blog/post/toward-rag-chatbot-part1/"><!-- Primary Meta Tags --><title>Building a Retrieval-Augmented Generation ChatBot - Part I (Dev notebook) â€¢ GÃ©nÃ©reux Akotenou&#39;s Blog</title><!-- ViewTransitions  --><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><!-- SEO --><meta name="title" content="Building a Retrieval-Augmented Generation ChatBot - Part I (Dev notebook) â€¢ GÃ©nÃ©reux Akotenou's Blog"><meta name="description" content="Explore the design and implementation of a Retrieval-Augmented Generation (RAG) ChatBot for assisting students at university. This RAG-powered ChatBot provides information about internal regulations using cutting-edge text mining techniques."><meta name="author" content="GÃ©nÃ©reux Akotenou"><!-- Open Graph / Facebook --><meta property="og:type" content="article"><meta property="og:url" content="https://genereux-akotenou.github.io/blog/post/toward-rag-chatbot-part1/"><meta property="og:title" content="Building a Retrieval-Augmented Generation ChatBot - Part I (Dev notebook)"><meta property="og:description" content="Explore the design and implementation of a Retrieval-Augmented Generation (RAG) ChatBot for assisting students at university. This RAG-powered ChatBot provides information about internal regulations using cutting-edge text mining techniques."><meta property="og:image" content="https://genereux-akotenou.github.io/_astro/rag.jze_rrGh.png"><meta property="article:author" content="GÃ©nÃ©reux Akotenou"><meta property="article:published_time" content="2024-11-05T22:00:00.000Z"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://genereux-akotenou.github.io/blog/post/toward-rag-chatbot-part1/"><meta property="twitter:title" content="Building a Retrieval-Augmented Generation ChatBot - Part I (Dev notebook)"><meta property="twitter:description" content="Explore the design and implementation of a Retrieval-Augmented Generation (RAG) ChatBot for assisting students at university. This RAG-powered ChatBot provides information about internal regulations using cutting-edge text mining techniques."><meta property="twitter:image" content="https://genereux-akotenou.github.io/_astro/rag.jze_rrGh.png"><!-- RSS auto-discovery --><link rel="alternate" type="application/rss+xml" title="GÃ©nÃ©reux Akotenou's Blog" href="/rss.xml"><link as="font" crossorigin rel="preload" href="/fonts/Manrope-Bold.woff2" type="font/woff2"><style>@font-face {font-weight: 200;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-ExtraLight.woff2)}</style><style>@font-face {font-weight: 300;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Light.woff2)}</style><style>@font-face {font-weight: 400;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Regular.woff2)}</style><style>@font-face {font-weight: 500;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Medium.woff2)}</style><style>@font-face {font-weight: 600;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-SemiBold.woff2)}</style><style>@font-face {font-weight: 700;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Bold.woff2)}</style><style>@font-face {font-weight: 800;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-ExtraBold.woff2)}</style><style>@font-face { font-family: _font_fallback_1731128338932; size-adjust: 103.76%; src: local('Arial'); ascent-override: 102.74%; descent-override: 28.91%; line-gap-override: 0.00%; }</style><script>
	function getTheme() {
		const storedTheme = typeof localStorage !== 'undefined' && localStorage.getItem('theme')

		return (
			storedTheme || (window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark')
		)
	}

	function setTheme(newTheme) {
		const html = document.documentElement
		const isDark = newTheme === 'dark'

		html.classList.toggle('dark', isDark)
		html.classList.toggle('light', !isDark)

		localStorage.setItem('theme', newTheme)
	}

	// set initial theme
	setTheme(getTheme())
	document.addEventListener('astro:after-swap', () => setTheme(getTheme()))

	document.addEventListener('theme-change', (e) => {
		setTheme(e.detail.theme)
	})
</script><script>
	if (!('animations' in localStorage)) {
		localStorage.setItem('animations', 'true')
	} else {
		localStorage.setItem('animations', 'false')
	}
</script><link rel="stylesheet" href="/_astro/_page_.REp-vSjj.css" />
<link rel="stylesheet" href="/_astro/_slug_.Z2S8p2iP.css" />
<style>.embed-refresh-v2[data-astro-cid-r2x3s5wt] .nav-primary--refresh[data-astro-cid-r2x3s5wt]{margin-bottom:24px;border-bottom:1px solid #c2c6cc!important}@media (min-width: 768px){.md\:text-6xl[data-astro-cid-l3utfwjv]{font-size:3rem!important;line-height:1}.md\:prose-xl[data-astro-cid-l3utfwjv] :where(h1):not(:where([class~=not-prose],[class~=not-prose] *))[data-astro-cid-l3utfwjv]{font-size:2em!important;margin-top:0;margin-bottom:.8571429em;line-height:1}.md\:prose-xl[data-astro-cid-l3utfwjv] :where(h2):not(:where([class~=not-prose],[class~=not-prose] *))[data-astro-cid-l3utfwjv]{font-size:1.3em!important;margin-top:1.5555556em;margin-bottom:.8888889em;line-height:1.1111111}}
</style><script type="module" src="/_astro/hoisted.JwB-sCMo.js"></script></head> <body class="bg-white text-stone-950 dark:bg-[#0a0910] dark:text-white" data-astro-cid-37fxchfa> <main class="px-5 sm:mx-auto sm:max-w-2xl sm:px-8 lg:px-0 antialiased md:max-w-6xl grid gap-12 mt-4 overflow-hidden md:overflow-visible" data-astro-cid-37fxchfa> <header class="relative flex items-center h-12 font-semibold" data-astro-cid-3ef6ksr2> <span style="display: flex; flex-direction: row;" class="text-lg mr-auto" data-astro-cid-3ef6ksr2> <a class="nav-link" href="/" data-astro-cid-3ef6ksr2>Resume</a>&nbsp;&nbsp;&nbsp;
<a class="nav-link active" href="/blog" data-astro-cid-3ef6ksr2>Blog</a>&nbsp;&nbsp;&nbsp;
<!--<a class={cn(`nav-link`, busIsActive && `active`)} href='/startup'>Business</a>&nbsp;&nbsp;-&nbsp;&nbsp;--> <a class="nav-link" href="/fun" data-astro-cid-3ef6ksr2>Fun Coding ðŸŽ‰</a> </span> <div id="astro-header-drawer" class="shadow rounded-l-lg md:bg-transparent dark:md:bg-transparent bg-white dark:bg-[#0a0910] md:shadow-none md:rounded-none md:border-none md:h-auto md:static absolute transition-transform duration-300 ease-in translate-x-96 md:translate-x-0 top-12 -right-5 pl-4 pt-6 pb-4 md:p-0 h-[200px] w-[200px] z-50" data-astro-cid-3ef6ksr2> <nav class="flex h-full flex-col justify-between gap-12 text-left md:flex-row md:w-full md:gap-5" data-astro-cid-3ef6ksr2> <div class="flex flex-col gap-4 md:flex-row md:border-r-2 border-black pr-4 dark:border-white" data-astro-cid-3ef6ksr2> <a href="/blog/tags" class="text-opacity-60 flex items-center gap-1 text-2xl md:text-base" rel="noopener noreferrer " data-astro-cid-3ef6ksr2>  <svg xmlns="http://www.w3.org/2000/svg" class="w-8 md:w-6" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M7.859 6h-2.834a2.025 2.025 0 0 0 -2.025 2.025v2.834c0 .537 .213 1.052 .593 1.432l6.116 6.116a2.025 2.025 0 0 0 2.864 0l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-6.117 -6.116a2.025 2.025 0 0 0 -1.431 -.593z"></path> <path d="M17.573 18.407l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-7.117 -7.116"></path> <path d="M6 9h-.01"></path> </svg> Tags
 </a> </div> <div class="flex justify-center items-center md:justify-end gap-3 md:p-0" data-astro-cid-3ef6ksr2> <a href="https://github.com/Genereux-akotenou" class="text-opacity-60" rel="noopener noreferrer " target="_blank" aria-label="Github" data-astro-cid-3ef6ksr2>  <span data-astro-cid-3ef6ksr2><svg xmlns="http://www.w3.org/2000/svg" class="w-8 md:w-6" viewBox="0 0 24 24" stroke-width="1.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path> </svg> </span>  </a><a href="https://www.linkedin.com/in/genereux-akotenou/" class="text-opacity-60" rel="noopener noreferrer " target="_blank" aria-label="linkedin" data-astro-cid-3ef6ksr2>  <span data-astro-cid-3ef6ksr2><svg enable-background="new 0 0 32 32" height="32px" id="Layer_1" version="1.0" viewBox="0 0 32 32" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M32,30c0,1.104-0.896,2-2,2H2c-1.104,0-2-0.896-2-2V2c0-1.104,0.896-2,2-2h28c1.104,0,2,0.896,2,2V30z" fill="#007BB5"></path><g><rect fill="#FFFFFF" height="14" width="4" x="7" y="11"></rect><path d="M20.499,11c-2.791,0-3.271,1.018-3.499,2v-2h-4v14h4v-8c0-1.297,0.703-2,2-2c1.266,0,2,0.688,2,2v8h4v-7    C25,14,24.479,11,20.499,11z" fill="#FFFFFF"></path><circle cx="9" cy="8" fill="#FFFFFF" r="2"></circle></g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg> </span>  </a> </div> </nav> </div> <div class="flex items-center gap-3 md:pl-3" data-astro-transition-persist="navbar" data-astro-cid-3ef6ksr2> <div data-astro-cid-3ef6ksr2> <site-search id="search" class="ms-auto"> <button data-open-modal disabled class="flex items-center justify-center rounded-md gap-1"> <svg aria-label="search" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"> <path stroke="none" d="M0 0h24v24H0z"></path> <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path> </svg> <!-- <span class='md:hidden text-2xl'> Search</span> --> </button> <dialog aria-label="search" class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-white dark:bg-[#0a0910ec] shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md opacity-0"> <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6"> <button data-close-modal class="ms-auto cursor-pointer rounded-full bg-black text-white px-4 py-2 dark:bg-white dark:text-black">Close</button> <div class="search-container dark:text-white"> <div id="pagefind__search"></div> </div> </div> </dialog> </site-search>   </div>  <theme-toggle class="relative h-6 w-6"> <button id="toggle-theme" class="group" aria-label="Toggle Theme"> <span class="absolute left-0 right-0 top-0 opacity-0 group-aria-pressed:opacity-100"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun-high" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z"></path> <path d="M6.343 17.657l-1.414 1.414"></path> <path d="M6.343 6.343l-1.414 -1.414"></path> <path d="M17.657 6.343l1.414 -1.414"></path> <path d="M17.657 17.657l1.414 1.414"></path> <path d="M4 12h-2"></path> <path d="M12 4v-2"></path> <path d="M20 12h2"></path> <path d="M12 20v2"></path> </svg> </span> <span class="absolute left-0 right-0 top-0 opacity-0 group-aria-[pressed=false]:opacity-100"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path> </svg> </span> </button> </theme-toggle> <script>
	const button = document.getElementById('toggle-theme')

	function setButtonPresssed() {
		const bodyThemeIsDark = document.documentElement.classList.contains('dark')
		button.setAttribute('aria-pressed', String(bodyThemeIsDark))
	}
	setButtonPresssed()
</script> <button id="astro-header-drawer-button" type="button" class="md:ml-6 md:hidden" data-astro-cid-3ef6ksr2> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M4 6l16 0"></path> <path d="M4 12l16 0"></path> <path d="M4 18l16 0"></path> </svg> <span class="sr-only" data-astro-cid-3ef6ksr2>Show Menu</span> </button> </div> </header>   <article class="min-w-full md:py-4 sm:max-w-none md:max-w-none"> <header class="mb-3 flex flex-col justify-center items-center gap-6"> <div class="flex flex-col gap-2"> <div class="flex items-center justify-center gap-x-1"> <p class="text-center text-sm text-opacity-50">
Published <time class="text-sm font-bold text-opacity-60" datetime="2024-11-05T22:00:00.000Z"> Nov 5, 2024 </time> </p> <p class="text-center text-sm text-opacity-50 font-bold">
- 10 min read </p> </div> <h1 class="text-center text-4xl md:text-6xl md:pb-2.5 font-semibold"> Building a Retrieval-Augmented Generation ChatBot - Part I (Dev notebook) </h1> </div> <div class="flex flex-wrap justify-center items-center gap-2 gap-y-4 md:gap-5"> <a href="/blog/tags/rag" aria-label="RAG"> <span class="bg-indigo-600 font-semibold text-white dark:bg-indigo-900 dark:text-white shadow text-sm w-fit px-2 py-1 md:px-5 md:py-2 rounded-full"> RAG </span> </a><a href="/blog/tags/chatbot" aria-label="ChatBot"> <span class="bg-indigo-600 font-semibold text-white dark:bg-indigo-900 dark:text-white shadow text-sm w-fit px-2 py-1 md:px-5 md:py-2 rounded-full"> ChatBot </span> </a><a href="/blog/tags/text mining" aria-label="Text Mining"> <span class="bg-indigo-600 font-semibold text-white dark:bg-indigo-900 dark:text-white shadow text-sm w-fit px-2 py-1 md:px-5 md:py-2 rounded-full"> Text Mining </span> </a><a href="/blog/tags/llm" aria-label="LLM"> <span class="bg-indigo-600 font-semibold text-white dark:bg-indigo-900 dark:text-white shadow text-sm w-fit px-2 py-1 md:px-5 md:py-2 rounded-full"> LLM </span> </a> </div> </header> <img src="/_astro/rag.jze_rrGh_2hdNyj.jpg" loading="eager" class="rounded-md w-full max-h-[300px]  md:max-h-[500px] my-8 object-cover" alt="img of Building a Retrieval-Augmented Generation ChatBot - Part I (Dev notebook)" width="1000" height="500" decoding="async"> <hr> <div> <div class="grid grid-cols-1 md:grid-cols-[20%_auto] gap-10 mt-8" data-astro-cid-l3utfwjv><!-- aside  --><aside class="md:flex flex-col gap-8 hidden" data-astro-cid-l3utfwjv><div class="flex flex-col gap-2"> <span class="mb-1 font-bold text-2xl">Share</span> <ul class="flex gap-3 text-black dark:text-white"> <li> <a href="https://twitter.com/intent/tweet?text=Share this post https://genereux-akotenou.github.io/blog/post/toward-rag-chatbot-part1/" aria-label="Share on Twitter"><!--?xml version="1.0" ?--><svg height="32px" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M448,512l-384,0c-35.328,0 -64,-28.672 -64,-64l0,-384c0,-35.328 28.672,-64 64,-64l384,0c35.328,0 64,28.672 64,64l0,384c0,35.328 -28.672,64 -64,64Z" id="Dark_Blue" style="fill:#1da1f2;fill-rule:nonzero;"></path><path d="M196.608,386.048c120.704,0 186.752,-100.096 186.752,-186.752c0,-2.816 0,-5.632 -0.128,-8.448c12.8,-9.216 23.936,-20.864 32.768,-34.048c-11.776,5.248 -24.448,8.704 -37.76,10.368c13.568,-8.064 23.936,-20.992 28.928,-36.352c-12.672,7.552 -26.752,12.928 -41.728,15.872c-12.032,-12.8 -29.056,-20.736 -47.872,-20.736c-36.224,0 -65.664,29.44 -65.664,65.664c0,5.12 0.64,10.112 1.664,14.976c-54.528,-2.688 -102.912,-28.928 -135.296,-68.608c-5.632,9.728 -8.832,20.992 -8.832,33.024c0,22.784 11.648,42.88 29.184,54.656c-10.752,-0.384 -20.864,-3.328 -29.696,-8.192l0,0.896c0,31.744 22.656,58.368 52.608,64.384c-5.504,1.536 -11.264,2.304 -17.28,2.304c-4.224,0 -8.32,-0.384 -12.288,-1.152c8.32,26.112 32.64,45.056 61.312,45.568c-22.528,17.664 -50.816,28.16 -81.536,28.16c-5.248,0 -10.496,-0.256 -15.616,-0.896c28.928,18.432 63.488,29.312 100.48,29.312" id="Logo__x2014__FIXED" style="fill:#fff;fill-rule:nonzero;"></path></g></svg></a> </li> <li> <a href="https://www.linkedin.com/shareArticle?mini=true&#38;url=https://genereux-akotenou.github.io/blog/post/toward-rag-chatbot-part1/" aria-label="Share on LinkedIn"> <svg enable-background="new 0 0 32 32" height="32px" id="Layer_1" version="1.0" viewBox="0 0 32 32" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M32,30c0,1.104-0.896,2-2,2H2c-1.104,0-2-0.896-2-2V2c0-1.104,0.896-2,2-2h28c1.104,0,2,0.896,2,2V30z" fill="#007BB5"></path><g><rect fill="#FFFFFF" height="14" width="4" x="7" y="11"></rect><path d="M20.499,11c-2.791,0-3.271,1.018-3.499,2v-2h-4v14h4v-8c0-1.297,0.703-2,2-2c1.266,0,2,0.688,2,2v8h4v-7    C25,14,24.479,11,20.499,11z" fill="#FFFFFF"></path><circle cx="9" cy="8" fill="#FFFFFF" r="2"></circle></g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></a> </li> </ul> </div><!--<a href="#disqus_thread">Link</a>--><div class="sticky top-24 self-start hidden md:block transition-all duration-200" data-astro-cid-l3utfwjv><nav class="max-w-xs dark:text-black"> <h1 class="font-bold mb-3 text-2xl dark:text-white">Index</h1> <ul class="[text-wrap:balance] flex flex-col gap-1"> <li class="flex flex-col"> <a href="#introduction-to-rag" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Introduction to RAG </a>  </li><li class="flex flex-col"> <a href="#rag-workflow" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> RAG Workflow </a>  </li><li class="flex flex-col"> <a href="#objectives" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Objectives </a>  </li><li class="flex flex-col"> <a href="#data-ingestion-pipeline" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Data Ingestion Pipeline </a> <ul class="ml-3"> <li class="flex flex-col"> <a href="#objectives-1" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Objectives </a>  </li><li class="flex flex-col"> <a href="#setup" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Setup </a>  </li><li class="flex flex-col"> <a href="#load-data" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Load Data </a>  </li><li class="flex flex-col"> <a href="#create-document-chuncks" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Create document chuncks </a>  </li><li class="flex flex-col"> <a href="#generate-embeddings-for-each-node" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Generate embeddings for each Node </a>  </li> </ul> </li><li class="flex flex-col"> <a href="#retrieval-and-generation-pipeline" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Retrieval and Generation pipeline </a> <ul class="ml-3"> <li class="flex flex-col"> <a href="#context-retrieval" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Context Retrieval </a>  </li><li class="flex flex-col"> <a href="#augemented-generation" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Augemented Generation </a>  </li> </ul> </li><li class="flex flex-col"> <a href="#conclusion" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Conclusion </a>  </li><li class="flex flex-col"> <a href="#automation-for-production-stage" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Automation for production-stage </a>  </li><li class="flex flex-col"> <a href="#open-questions" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Open questions </a>  </li> </ul> </nav></div></aside><!-- post --><article class="max-w-full w-full" data-astro-cid-l3utfwjv><div style_="transform: scale(0.9); transform-origin: top;" data-astro-cid-l3utfwjv><div class="prose prose-lg md:prose-xl dark:prose-invert mb-12 min-w-full" data-astro-cid-l3utfwjv><p><strong>Retrieval-Augmented Generation (RAG) bridges the gap between general and specific data understanding, enabling Large Language Models (LLMs) to generate accurate, data-specific responses.</strong></p>
<h1 id="introduction-to-rag">Introduction to RAG</h1>
<p>Large Language Models (LLMs) excel at reasoning with general data, but their performance diminishes when tasked with specific data, particularly when that data was generated after their training. To create applications that can comprehend private information or details beyond the modelâ€™s existing knowledge, it is essential to enrich the modelâ€™s understanding with specific information. This process of retrieving relevant information and integrating it into the model to generate accurate responses for particular datasets is referred to as Retrieval Augmented Generation (RAG).</p>
<p>In short points:</p>
<ul>
<li><strong>General vs. Specific Data</strong>: LLMs, like GPT models, excel at reasoning over general data but often falter with domain-specific or recently updated information.</li>
<li><strong>Challenge</strong>: LLMs cannot natively process new information that arises post-training.</li>
<li><strong>Solution</strong>: RAG provides a framework for retrieving relevant data from external sources and augmenting LLM outputs. This hybrid approach ensures responses are both data-rich and contextually accurate.</li>
</ul>
<h2 id="rag-workflow">RAG Workflow</h2>
<p>The RAG architecture involves:</p>
<ul>
<li><strong>Data Ingestion</strong>: Collecting, chunking, and embedding data for efficient retrieval.</li>
<li><strong>Retrieval Process</strong>: Using embeddings to fetch the most relevant pieces of information.</li>
<li><strong>Generation</strong>: Combining retrieved data with the LLM for response generation.</li>
</ul>
<p><img alt="RAG Architecture"  src="/_astro/Simple_RAG_Architecture.drawio.vQbM6Ozk_hQBLA.webp" width="1001" height="611" loading="lazy" decoding="async"><br>
<strong>Image 1: RAG Workflow Illustration</strong></p>
<h2 id="objectives">Objectives</h2>
<p><img alt="RAG Objectives"  src="/_astro/objectives.Hxa8FZjq_1Q15Vj.webp" width="1906" height="1132" loading="lazy" decoding="async"></p>
<div style="background-color: #f68f64; color: white; padding: 0.7em; border-radius: 0.4em;">
The main goal of this paper is to develop a RAG-powered ChatBot following the architecture proposed in <a href="#image-1">Image 1</a> that assists students by providing easily accessible and up-to-date information about university regulations. We will build the chatbot using the Llama3 model. To enable this model to work on private documents and deliver accurate results, we will carefully select and build a more precise context for the LLM using RAG.
</div>
<h2 id="data-ingestion-pipeline">Data Ingestion Pipeline</h2>
<p>This section outlines the development of the Data Ingestion pipeline, which forms the first component of our architecture (see Image 1). We begin by implementing a Python script to orchestrate the data ingestion process and later automate this workflow using tools like Apache Airflow. Here is a breakdown of our objectives and the steps involved:</p>
<hr>
<h3 id="objectives-1">Objectives</h3>
<ul>
<li>Build a Data Ingestion pipeline to process new documents.</li>
<li>Extract text from various document formats and convert them into manageable chunks.</li>
<li>Index these chunks and generate embedding vectors to store in a database.</li>
</ul>
<h3 id="setup">Setup</h3>
<p>In our root directory, we will create a development folder to house all our scripts. For the initial processing step, we will create a new <code>.ipynb</code> file that will contain the complete data processing pipeline.</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">  â”œâ”€â”¬ DEV</span></span>
<span class="line"><span style="color:#89DDFF"><span style="user-select: none;">+</span></span><span style="color:#C3E88D">   â”œâ”€â”€ 1_Data_Ingestion.ipynb</span></span>
<span class="line"><span style="color:#BABED8">    â”œâ”€â”€ 2_Context_Retrieval.ipynb</span></span>
<span class="line"><span style="color:#BABED8">    â”œâ”€â”€ database</span></span>
<span class="line"><span style="color:#BABED8">    â”œâ”€â”¬ documents</span></span>
<span class="line"><span style="color:#BABED8">    â”‚ â””â”€â”€ *.pdf(Folder to add new documents)</span></span></code></pre>
<p>In this section we edit the <code>1_Data_Ingestion.ipynb</code> file. Letâ€™s install and import utils</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF">%</span><span style="color:#BABED8">pip install llama</span><span style="color:#89DDFF">-</span><span style="color:#BABED8">index</span><span style="color:#89DDFF">-</span><span style="color:#BABED8">readers</span><span style="color:#89DDFF">-</span><span style="color:#BABED8">file pymupdf</span></span>
<span class="line"><span style="color:#89DDFF">%</span><span style="color:#BABED8">pip install llama</span><span style="color:#89DDFF">-</span><span style="color:#BABED8">index</span><span style="color:#89DDFF">-</span><span style="color:#BABED8">vector</span><span style="color:#89DDFF">-</span><span style="color:#BABED8">stores</span><span style="color:#89DDFF">-</span><span style="color:#BABED8">postgres</span></span>
<span class="line"><span style="color:#89DDFF">%</span><span style="color:#BABED8">pip install llama</span><span style="color:#89DDFF">-</span><span style="color:#BABED8">index</span><span style="color:#89DDFF">-</span><span style="color:#BABED8">embeddings</span><span style="color:#89DDFF">-</span><span style="color:#BABED8">hugging face</span></span>
<span class="line"><span style="color:#89DDFF">%</span><span style="color:#BABED8">pip install llama</span><span style="color:#89DDFF">-</span><span style="color:#BABED8">index</span><span style="color:#89DDFF">-</span><span style="color:#BABED8">llms</span><span style="color:#89DDFF">-</span><span style="color:#BABED8">llama</span><span style="color:#89DDFF">-</span><span style="color:#BABED8">cpp</span></span>
<span class="line"><span style="color:#89DDFF">%</span><span style="color:#BABED8">pip install llama</span><span style="color:#89DDFF">-</span><span style="color:#BABED8">cpp</span><span style="color:#89DDFF">-</span><span style="color:#BABED8">python</span></span></code></pre>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> llama_index</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">embeddings</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">huggingface </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> HuggingFaceEmbedding</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> tqdm </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> tqdm</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> os</span></span></code></pre>
<p>We need to convert text into vectors as a key functionality. Our goal is to build a chatbot for French documents, so we researched embedding models available on Hugging Face. Using the leaderboard at <a href="https://huggingface.co/spaces/mteb/leaderboard">this link</a>, we selected <code>bge-m3-custom-fr</code> for its optimal balance between computational efficiency and performance. Refer to <a href="#image-2">Image 2</a> below, which illustrates the model parameters we considered for this choice.</p>
<p><img alt="RAG Architecture"  src="/_astro/model.mD5DfejK_ZPvzgX.webp" width="2420" height="720" loading="lazy" decoding="async"><br>
<strong>Image 2: Model Parameter Selection for RAG Workflow</strong></p>
<p>We then create an instance of our embedding model using the following code:</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">embed_model </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> HuggingFaceEmbedding</span><span style="color:#89DDFF">(</span><span style="color:#BABED8;font-style:italic">model_name</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">manu/bge-m3-custom-fr</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span></code></pre>
<p>Once we have the embedding model ready, we need a database to store the vectors of document chunks that our chatbot will use.</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic"># Let's create database folder to setup our DB</span></span>
<span class="line"><span style="color:#89DDFF">!</span><span style="color:#FFCB6B"> mkdir</span><span style="color:#C3E88D"> database</span></span></code></pre>
<p>Next, we need to create a <code>docker-compose.yml</code> file to provision a PostgreSQL database that supports <code>pgvector</code>. This support is essential because <code>pgvector</code> allows us to efficiently handle and query vector data within our database.</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF">%</span><span style="color:#BABED8">%writefile database/docker-compose.yml</span></span>
<span class="line"><span style="color:#F07178">version</span><span style="color:#89DDFF">:</span><span style="color:#89DDFF"> '</span><span style="color:#C3E88D">3.8</span><span style="color:#89DDFF">'</span></span>
<span class="line"><span style="color:#F07178">services</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#F07178">  RAG_DB</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#F07178">    image</span><span style="color:#89DDFF">:</span><span style="color:#C3E88D"> ankane/pgvector</span></span>
<span class="line"><span style="color:#F07178">    container_name</span><span style="color:#89DDFF">:</span><span style="color:#C3E88D"> rag_vector_db</span></span>
<span class="line"><span style="color:#F07178">    environment</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#F07178">      POSTGRES_DB</span><span style="color:#89DDFF">:</span><span style="color:#C3E88D"> rag_vector_db</span></span>
<span class="line"><span style="color:#F07178">      POSTGRES_USER</span><span style="color:#89DDFF">:</span><span style="color:#C3E88D"> rag_user</span></span>
<span class="line"><span style="color:#F07178">      POSTGRES_PASSWORD</span><span style="color:#89DDFF">:</span><span style="color:#C3E88D"> rag_password</span></span>
<span class="line"><span style="color:#F07178">    ports</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#89DDFF">      -</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">5433:5432</span><span style="color:#89DDFF">"</span></span>
<span class="line"><span style="color:#F07178">    volumes</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#89DDFF">      -</span><span style="color:#C3E88D"> ./pgdata:/var/lib/postgresql/data</span></span></code></pre>
<p>We then start our Docker container to provision the database server:</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF">!</span><span style="color:#82AAFF"> cd</span><span style="color:#C3E88D"> database</span><span style="color:#89DDFF"> ;</span><span style="color:#FFCB6B"> docker-compose</span><span style="color:#C3E88D"> up</span><span style="color:#C3E88D"> -d</span><span style="color:#C3E88D"> RAG_DB</span></span></code></pre>
<p>Expected output:</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span>[+] Running 1/0</span></span>
<span class="line"><span> âœ” Container rag_vector_db  Running </span></span></code></pre>
<p>After installing and starting our Docker container that provisions a database server on port 5433, we connect to the database and set it up. We use <code>pgvector</code> for efficient manipulation of vector data. The following code connects to the server and creates our database:</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> psycopg2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic"># DB Parameters</span></span>
<span class="line"><span style="color:#BABED8">db_name </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">rag_vector_db</span><span style="color:#89DDFF">"</span></span>
<span class="line"><span style="color:#BABED8">host </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">localhost</span><span style="color:#89DDFF">"</span></span>
<span class="line"><span style="color:#BABED8">password </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">rag_password</span><span style="color:#89DDFF">"</span></span>
<span class="line"><span style="color:#BABED8">port </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">5433</span><span style="color:#89DDFF">"</span></span>
<span class="line"><span style="color:#BABED8">user </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">rag_user</span><span style="color:#89DDFF">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic"># Connect and create db</span></span>
<span class="line"><span style="color:#BABED8">conn </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> psycopg2</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">connect</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    dbname</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">postgres</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    host</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">host</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    password</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">password</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    port</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">port</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    user</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">user</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">conn</span><span style="color:#89DDFF">.</span><span style="color:#F07178">autocommit</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> True</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">with</span><span style="color:#BABED8"> conn</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">cursor</span><span style="color:#89DDFF">()</span><span style="color:#89DDFF;font-style:italic"> as</span><span style="color:#BABED8"> c</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#BABED8">    c</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">execute</span><span style="color:#89DDFF">(</span><span style="color:#C792EA">f</span><span style="color:#C3E88D">"DROP DATABASE IF EXISTS </span><span style="color:#F78C6C">{</span><span style="color:#82AAFF">db_name</span><span style="color:#F78C6C">}</span><span style="color:#C3E88D">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">    c</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">execute</span><span style="color:#89DDFF">(</span><span style="color:#C792EA">f</span><span style="color:#C3E88D">"CREATE DATABASE </span><span style="color:#F78C6C">{</span><span style="color:#82AAFF">db_name</span><span style="color:#F78C6C">}</span><span style="color:#C3E88D">"</span><span style="color:#89DDFF">)</span></span></code></pre>
<p>Next, we set up <strong>PGVectorStore</strong>, which provides functionality for writing and querying vector data in PostgreSQL:</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> llama_index</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">vector_stores</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">postgres </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> PGVectorStore</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8">vector_store </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> PGVectorStore</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">from_params</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    database</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">db_name</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    host</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">host</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    password</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">password</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    port</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">port</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    user</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">user</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    table_name</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">rag_paper_fr</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    embed_dim</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1024</span><span style="color:#89DDFF">,</span><span style="color:#676E95;font-style:italic">  # (384) openai embedding dimension</span></span>
<span class="line"><span style="color:#89DDFF">)</span></span></code></pre>
<h3 id="load-data">Load Data</h3>
<p>We have a folder named <code>documents</code> that contains .pdf documents. This snippet of code extracts text from each PDF and stores them as a list of documents:</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> pathlib </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> Path</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> llama_index</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">readers</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">file </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> PyMuPDFReader</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic"># Utils</span></span>
<span class="line"><span style="color:#BABED8">loader </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> PyMuPDFReader</span><span style="color:#89DDFF">()</span></span>
<span class="line"><span style="color:#BABED8">directory_path </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> Path</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">./documents</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">pdf_files </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> directory_path</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">glob</span><span style="color:#89DDFF">(</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">*.pdf</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic"># Process and rename all PDF files</span></span>
<span class="line"><span style="color:#BABED8">documents </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> []</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">for</span><span style="color:#BABED8"> file_path </span><span style="color:#89DDFF;font-style:italic">in</span><span style="color:#BABED8"> pdf_files</span><span style="color:#89DDFF">:</span></span>
<span class="line"><span style="color:#BABED8">    loaded_docs </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> loader</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">load</span><span style="color:#89DDFF">(</span><span style="color:#BABED8;font-style:italic">file_path</span><span style="color:#89DDFF">=</span><span style="color:#FFCB6B">str</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">file_path</span><span style="color:#89DDFF">))</span></span>
<span class="line"><span style="color:#BABED8">    documents</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">extend</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">loaded_docs</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">    treated_file_path </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> file_path</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">with_name</span><span style="color:#89DDFF">(</span><span style="color:#C792EA">f</span><span style="color:#C3E88D">"</span><span style="color:#F78C6C">{</span><span style="color:#82AAFF">file_path</span><span style="color:#89DDFF">.</span><span style="color:#F07178">stem</span><span style="color:#F78C6C">}</span><span style="color:#C3E88D">.pdf"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">    file_path</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">rename</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">treated_file_path</span><span style="color:#89DDFF">)</span></span></code></pre>
<h3 id="create-document-chuncks">Create document chuncks</h3>
<p>Chunking plays a crucial role in building RAG. Since documents can be large, itâ€™s necessary to split them into manageable sizes to ensure efficient indexing and retrieval. We must define a <code>chunk_size</code>, which specifies the number of tokens each chunk will contain.</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> llama_index</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">core</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">node_parser </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> SentenceSplitter</span></span>
<span class="line"><span style="color:#BABED8">text_parser </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> SentenceSplitter</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    chunk_size</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1024</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8">text_chunks </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> []</span></span>
<span class="line"><span style="color:#BABED8">doc_idxs </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> []</span><span style="color:#676E95;font-style:italic"> #&#x3C;- to save index</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">for</span><span style="color:#BABED8"> doc_idx</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> doc </span><span style="color:#89DDFF;font-style:italic">in</span><span style="color:#82AAFF"> enumerate</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">documents</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#BABED8">    cur_text_chunks </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> text_parser</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">split_text</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">doc</span><span style="color:#89DDFF">.</span><span style="color:#F07178">text</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">    text_chunks</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">extend</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">cur_text_chunks</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">    doc_idxs</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">extend</span><span style="color:#89DDFF">([</span><span style="color:#82AAFF">doc_idx</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> *</span><span style="color:#82AAFF"> len</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">cur_text_chunks</span><span style="color:#89DDFF">))</span></span></code></pre>
<p>Letâ€™s link each chunck to document sources metadata (Node Chunk)</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> llama_index</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">core</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">schema </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> TextNode</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8">nodes </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> []</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">for</span><span style="color:#BABED8"> idx</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> text_chunk </span><span style="color:#89DDFF;font-style:italic">in</span><span style="color:#82AAFF"> enumerate</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">text_chunks</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#BABED8">    node </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> TextNode</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">        text</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">text_chunk</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    )</span></span>
<span class="line"><span style="color:#BABED8">    src_doc </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> documents</span><span style="color:#89DDFF">[</span><span style="color:#BABED8">doc_idxs</span><span style="color:#89DDFF">[</span><span style="color:#BABED8">idx</span><span style="color:#89DDFF">]]</span></span>
<span class="line"><span style="color:#BABED8">    node</span><span style="color:#89DDFF">.</span><span style="color:#F07178">metadata</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> src_doc</span><span style="color:#89DDFF">.</span><span style="color:#F07178">metadata</span></span>
<span class="line"><span style="color:#BABED8">    nodes</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">append</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">node</span><span style="color:#89DDFF">)</span></span></code></pre>
<h3 id="generate-embeddings-for-each-node">Generate embeddings for each Node</h3>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">for</span><span style="color:#BABED8"> node </span><span style="color:#89DDFF;font-style:italic">in</span><span style="color:#82AAFF"> tqdm</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">nodes</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> ncols</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">100</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> desc</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">Generating embedding: </span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#BABED8">    node_embedding </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> embed_model</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">get_text_embedding</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#82AAFF">        node</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">get_content</span><span style="color:#89DDFF">(</span><span style="color:#BABED8;font-style:italic">metadata_mode</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">all</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#89DDFF">    )</span></span>
<span class="line"><span style="color:#BABED8">    node</span><span style="color:#89DDFF">.</span><span style="color:#F07178">embedding</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> node_embedding</span></span></code></pre>
<p>Generating embedding: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 166/166 [01:14&#x3C;00:00,  2.24it/s]</p>
<p>We cna get a look quick of the content of the first node:</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">nodes</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">dict</span><span style="color:#89DDFF">().</span><span style="color:#82AAFF">keys</span><span style="color:#89DDFF">()</span></span></code></pre>
<p>dict_keys([â€˜id_â€™, â€˜embeddingâ€™, â€˜metadataâ€™, â€˜excluded_embed_metadata_keysâ€™, â€˜excluded_llm_metadata_keysâ€™, â€˜relationshipsâ€™, â€˜textâ€™, â€˜mimetypeâ€™, â€˜start_char_idxâ€™, â€˜end_char_idxâ€™, â€˜text_templateâ€™, â€˜metadata_templateâ€™, â€˜metadata_seperatorâ€™, â€˜class_nameâ€™])</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">nodes</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">dict</span><span style="color:#89DDFF">()[</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">id_</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">]</span></span></code></pre>
<p>â€˜cf92f9c9-834c-4e2e-896d-1b11dfb1fc0aâ€™</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">nodes</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">dict</span><span style="color:#89DDFF">()[</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">metadata</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">]</span></span></code></pre>
<p>{â€˜total_pagesâ€™: 6,
â€˜file_pathâ€™: â€˜documents/UM6P-Disciplinary_Council.pdfâ€™,
â€˜sourceâ€™: â€˜1â€™}</p>
<p>We could the the built embedding here:</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">nodes</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">dict</span><span style="color:#89DDFF">()[</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">embedding</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">]</span></span></code></pre>
<p>[-0.030031858012080193,
-0.038829609751701355,
-0.0006665196851827204,
-0.06863262504339218,
-0.033711548894643784,
0.020719563588500023,
0.014222200959920883,
-0.0631137564778328,
-0.029535768553614616,
-0.0323270708322525,
0.002012217417359352,
-0.012179107405245304,
-0.01191095542162656
â€¦
-0.01191095542162656]</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#82AAFF">len</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">nodes</span><span style="color:#89DDFF">[</span><span style="color:#F78C6C">0</span><span style="color:#89DDFF">].</span><span style="color:#82AAFF">dict</span><span style="color:#89DDFF">()[</span><span style="color:#89DDFF">'</span><span style="color:#C3E88D">embedding</span><span style="color:#89DDFF">'</span><span style="color:#89DDFF">])</span></span></code></pre>
<p>1024</p>
<ol start="5">
<li>Store embedding vector into PostgresSQL DB:</li>
</ol>
<p>Finally, we store the generated embeddings for each document chunk in the database. This setup ensures that when we initiate the retrieval process for a given query, we can efficiently access the vector that best matches the input, enabling quick and accurate information retrieval.</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">vector_store</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">add</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">nodes</span><span style="color:#89DDFF">)</span></span></code></pre>
<h2 id="retrieval-and-generation-pipeline">Retrieval and Generation pipeline</h2>
<p><img alt="RAG Architecture"  src="/_astro/Capture_19.39.16.Z7HEHZ5V_Z1f4Tkd.webp" width="1924" height="1172" loading="lazy" decoding="async"></p>
<!-- **Image 3: Model Parameter Selection for RAG Workflow** -->
<p>In this section we will edit <code>2_Data_Ingestion.ipynb</code> file:</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">  â”œâ”€â”¬ DEV</span></span>
<span class="line"><span style="color:#BABED8">    â”œâ”€â”€ 1_Data_Ingestion.ipynb</span></span>
<span class="line"><span style="color:#89DDFF"><span style="user-select: none;">+</span></span><span style="color:#C3E88D">   â”œâ”€â”€ 2_Context_Retrieval.ipynb</span></span>
<span class="line"><span style="color:#BABED8">    â”œâ”€â”€ database</span></span>
<span class="line"><span style="color:#BABED8">    â”œâ”€â”¬ documents</span></span>
<span class="line"><span style="color:#BABED8">    â”‚ â””â”€â”€ *.pdf(Folder to add new documents)</span></span></code></pre>
<h3 id="context-retrieval">Context Retrieval</h3>
<p>Letâ€™s say we have one query about <code>how we can join the career center at UM6P ?</code> The first step is to build an embedding vector corresponding to our query, as shown in the code cell above.</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> llama_index</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">embeddings</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">huggingface </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> HuggingFaceEmbedding</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8">embed_model </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> HuggingFaceEmbedding</span><span style="color:#89DDFF">(</span><span style="color:#BABED8;font-style:italic">model_name</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">manu/bge-m3-custom-fr</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#BABED8">query_str   </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">Comment contacter le carrier center ?</span><span style="color:#89DDFF">"</span></span>
<span class="line"><span style="color:#BABED8">query_embedding </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> embed_model</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">get_query_embedding</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">query_str</span><span style="color:#89DDFF">)</span></span></code></pre>
<p>The next step is to query our vector database to search for the document chunk that best matches our query. The following code will search for the top 2 matching documents using <code>cosine similarity</code>.</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> llama_index</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">core</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">vector_stores </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> VectorStoreQuery</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8">query_mode </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">default</span><span style="color:#89DDFF">"</span><span style="color:#676E95;font-style:italic"> # "sparse" or "hybrid"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8">vector_store_query </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> VectorStoreQuery</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    query_embedding</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">query_embedding</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> similarity_top_k</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">2</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> mode</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">query_mode</span></span>
<span class="line"><span style="color:#89DDFF">)</span></span></code></pre>
<p>As we are doing this in a new notebook, we need to connect to our database and retrieve our vector store so we can launch our similarity search.</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> llama_index</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">vector_stores</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">postgres </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> PGVectorStore</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic"># DB Parameters</span></span>
<span class="line"><span style="color:#BABED8">db_name </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">rag_vector_db</span><span style="color:#89DDFF">"</span></span>
<span class="line"><span style="color:#BABED8">host </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">localhost</span><span style="color:#89DDFF">"</span></span>
<span class="line"><span style="color:#BABED8">password </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">rag_password</span><span style="color:#89DDFF">"</span></span>
<span class="line"><span style="color:#BABED8">port </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">5433</span><span style="color:#89DDFF">"</span></span>
<span class="line"><span style="color:#BABED8">user </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">rag_user</span><span style="color:#89DDFF">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8">vector_store </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> PGVectorStore</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">from_params</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    database</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">db_name</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    host</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">host</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    password</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">password</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    port</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">port</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    user</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">user</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    table_name</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">rag_paper_fr</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    embed_dim</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">1024</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic"># Similarity search</span></span>
<span class="line"><span style="color:#BABED8">query_result </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> vector_store</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">query</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">vector_store_query</span><span style="color:#89DDFF">)</span></span></code></pre>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">query_result</span><span style="color:#89DDFF">.</span><span style="color:#F07178">ids</span></span></code></pre>
<p>Here we have ids of matching documents:
[â€˜0d538711-cf99-46b1-af72-1aff9f98474bâ€™,
â€˜c4e5c5b5-9134-4c25-a84f-76c89ab4aff9â€™]</p>
<p>We can even look at similarityes score :</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">query_result</span><span style="color:#89DDFF">.</span><span style="color:#F07178">similarities</span></span></code></pre>
<p>[0.62223181459782, 0.5314870793513788]</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">query_result</span><span style="color:#89DDFF">.</span><span style="color:#F07178">nodes</span></span></code></pre>
<p>The ouput should look like this:</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span>[TextNode(id_='0d538711-cf99-46b1-af72-1aff9f98474b', embedding=None, metadata={'total_pages': 2, 'file_path': 'documents/UM6P-Phone_contact.pdf', 'source': '1'}, excluded_embed_metadata_keys=[], excluded_llm_metadata_keys=[], relationships={}, text='62\nCONTACTS\xa0:\nAdresse email\nTÃ©lÃ©phone\nCareer Center\nComplexe sportif \nFacilities\nHealth Center\nHelpdesk informatique\nLanguage Lab\nLearning Center / \nBibliothÃ¨que\nMahir center\nBenguerir : Career.center@um6p.ma \nRabat : SCALE\nPole.sport@um6p.ma pour le \ncampus de Benguerir\nPole.sportcr@um6p.ma pour le \ncampus de Rabat\nHÃ©bergement : housingrequest@um6p.ma\nRestauration : cateringrequest@um6p.ma\nConsultation Ã  distance\nAstreinte Health Center 7j/7\net 24H/24\nhealth.center@um6p.ma \nBenguÃ©rir : helpdesk@um6p.ma \nAstreinte 7j/7 et 24H/24\nIT Support RABAT:\nit-support-rabat@um6p.ma\nlanguagelab@um6p.ma \nBenguÃ©rir : lc@um6p.ma\nPortail : https://learningcenter.um6p.ma\nBureaux des aides documentalistes :\nBureau 1\nBureau 2\nRabat : bibliotheque.fgses@um6p.ma\nhttps://biblio.fgses-um6p.ma/\nmahircenter@um6p.ma \n05 25 07 27 00\n05 25 07 27 10\n06 16 14 01 93\n06 66 96 80 08\n05 25 07 32 04\n06 78 82 69 33 \n05 30 43 15 15\n05 25 07 28 97 \n05 25 07 32 00', mimetype='text/plain', start_char_idx=None, end_char_idx=None, text_template='{metadata_str}\n\n{content}', metadata_template='{key}: {value}', metadata_seperator='\n'),</span></span>
<span class="line"><span> TextNode(id_='c4e5c5b5-9134-4c25-a84f-76c89ab4aff9', embedding=None, metadata={'total_pages': 2, 'file_path': 'documents/UM6P-Phone_contact.pdf', 'source': '2'}, excluded_embed_metadata_keys=[], excluded_llm_metadata_keys=[], relationships={}, text='63\nRegistrariat\nSOLE (Student \nOrganizations, Leadership \nand Engagement)\nSAC (Student Activities \nCenter)\nStartgate\n1337 - Ã©cole de \ncodage\nBenguerir : anas.benyoussef@um6p.ma\nRabat : bennaceur.baahmad@um6p.ma\nregistrariat@um6p.ma \nsole@um6p.ma\nsac@um6p.ma\nhello@startgate.ma\nhttps://startgate.ma/ \nhind@1337.ma; Yassir@1337.ma', mimetype='text/plain', start_char_idx=None, end_char_idx=None, text_template='{metadata_str}\n\n{content}', metadata_template='{key}: {value}', metadata_seperator='\n')]</span></span></code></pre>
<p>As we can see, this has selected the best document chunk containing the response or contact information related to the career center. This will be a good context for the generation part.</p>
<h3 id="augemented-generation">Augemented Generation</h3>
<p>Now that we have a context that likely contains the best response for the query, we need to use a LLM to generate a response based on this context. Here, we use Llama2.</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> llama_index</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">llms</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">llama_cpp </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> LlamaCPP</span></span>
<span class="line"><span style="color:#BABED8">model_url </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">https://huggingface.co/TheBloke/Llama-2-13B-chat-GGUF/resolve/main/llama-2-13b-chat.Q4_0.gguf</span><span style="color:#89DDFF">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8">llm </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> LlamaCPP</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    model_url</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">model_url</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    model_path</span><span style="color:#89DDFF">=None,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    temperature</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">0.1</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    max_new_tokens</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">256</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    context_window</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">3900</span><span style="color:#89DDFF">,</span><span style="color:#676E95;font-style:italic"> #up to 4096</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    generate_kwargs</span><span style="color:#89DDFF">={},</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    model_kwargs</span><span style="color:#89DDFF">={</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">n_gpu_layers</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">:</span><span style="color:#F78C6C"> 1</span><span style="color:#89DDFF">},</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">    verbose</span><span style="color:#89DDFF">=True,</span></span>
<span class="line"><span style="color:#89DDFF">)</span></span></code></pre>
<p>We will build a retriever that will help us automatically retrieve context and send it to our LLM as query context.</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> llama_index</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">core </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> QueryBundle</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> llama_index</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">core</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">retrievers </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> BaseRetriever</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> typing </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> Any</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> List</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">class</span><span style="color:#FFCB6B"> VectorDBRetriever</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">BaseRetriever</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">    """</span><span style="color:#676E95;font-style:italic">Retriever over a postgres vector store.</span><span style="color:#89DDFF;font-style:italic">"""</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> __init__</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#F07178;font-style:italic">        self</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">        vector_store</span><span style="color:#89DDFF">:</span><span style="color:#BABED8"> PGVectorStore</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">        embed_model</span><span style="color:#89DDFF">:</span><span style="color:#BABED8"> Any</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">        query_mode</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> str</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">default</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">        similarity_top_k</span><span style="color:#89DDFF">:</span><span style="color:#FFCB6B"> int</span><span style="color:#89DDFF"> =</span><span style="color:#F78C6C"> 2</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">    )</span><span style="color:#89DDFF"> -></span><span style="color:#89DDFF"> None:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        """</span><span style="color:#676E95;font-style:italic">Init params.</span><span style="color:#89DDFF;font-style:italic">"""</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">_vector_store</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> vector_store</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">_embed_model</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> embed_model</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">_query_mode</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> query_mode</span></span>
<span class="line"><span style="color:#BABED8">        self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">_similarity_top_k</span><span style="color:#89DDFF"> =</span><span style="color:#BABED8"> similarity_top_k</span></span>
<span class="line"><span style="color:#FFCB6B">        super</span><span style="color:#89DDFF">().</span><span style="color:#82AAFF">__init__</span><span style="color:#89DDFF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA">    def</span><span style="color:#82AAFF"> _retrieve</span><span style="color:#89DDFF">(</span><span style="color:#F07178;font-style:italic">self</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> query_bundle</span><span style="color:#89DDFF">:</span><span style="color:#BABED8"> QueryBundle</span><span style="color:#89DDFF">)</span><span style="color:#89DDFF"> -></span><span style="color:#BABED8"> List</span><span style="color:#89DDFF">[</span><span style="color:#BABED8">NodeWithScore</span><span style="color:#89DDFF">]:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        """</span><span style="color:#676E95;font-style:italic">Retrieve.</span><span style="color:#89DDFF;font-style:italic">"""</span></span>
<span class="line"><span style="color:#BABED8">        query_embedding </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> embed_model</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">get_query_embedding</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#82AAFF">            query_bundle</span><span style="color:#89DDFF">.</span><span style="color:#F07178">query_str</span></span>
<span class="line"><span style="color:#89DDFF">        )</span></span>
<span class="line"><span style="color:#BABED8">        vector_store_query </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> VectorStoreQuery</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">            query_embedding</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">query_embedding</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">            similarity_top_k</span><span style="color:#89DDFF">=</span><span style="color:#BABED8">self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">_similarity_top_k</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#BABED8;font-style:italic">            mode</span><span style="color:#89DDFF">=</span><span style="color:#BABED8">self</span><span style="color:#89DDFF">.</span><span style="color:#F07178">_query_mode</span><span style="color:#89DDFF">,</span></span>
<span class="line"><span style="color:#89DDFF">        )</span></span>
<span class="line"><span style="color:#BABED8">        query_result </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> vector_store</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">query</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">vector_store_query</span><span style="color:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8">        nodes_with_scores </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> []</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        for</span><span style="color:#BABED8"> index</span><span style="color:#89DDFF">,</span><span style="color:#BABED8"> node </span><span style="color:#89DDFF;font-style:italic">in</span><span style="color:#82AAFF"> enumerate</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">query_result</span><span style="color:#89DDFF">.</span><span style="color:#F07178">nodes</span><span style="color:#89DDFF">):</span></span>
<span class="line"><span style="color:#BABED8">            score</span><span style="color:#89DDFF">:</span><span style="color:#BABED8"> Optional</span><span style="color:#89DDFF">[</span><span style="color:#FFCB6B">float</span><span style="color:#89DDFF">]</span><span style="color:#89DDFF"> =</span><span style="color:#89DDFF"> None</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">            if</span><span style="color:#BABED8"> query_result</span><span style="color:#89DDFF">.</span><span style="color:#F07178">similarities</span><span style="color:#89DDFF"> is</span><span style="color:#89DDFF"> not</span><span style="color:#89DDFF"> None:</span></span>
<span class="line"><span style="color:#BABED8">                score </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> query_result</span><span style="color:#89DDFF">.</span><span style="color:#F07178">similarities</span><span style="color:#89DDFF">[</span><span style="color:#F07178">index</span><span style="color:#89DDFF">]</span></span>
<span class="line"><span style="color:#BABED8">            nodes_with_scores</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">append</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">NodeWithScore</span><span style="color:#89DDFF">(</span><span style="color:#BABED8;font-style:italic">node</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">node</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> score</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">score</span><span style="color:#89DDFF">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic">        return</span><span style="color:#BABED8"> nodes_with_scores</span></span></code></pre>
<p>Here is the pipeline:</p>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">retriever </span><span style="color:#89DDFF">=</span><span style="color:#82AAFF"> VectorDBRetriever</span><span style="color:#89DDFF">(</span></span>
<span class="line"><span style="color:#82AAFF">    vector_store</span><span style="color:#89DDFF">,</span><span style="color:#82AAFF"> embed_model</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> query_mode</span><span style="color:#89DDFF">=</span><span style="color:#89DDFF">"</span><span style="color:#C3E88D">default</span><span style="color:#89DDFF">"</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> similarity_top_k</span><span style="color:#89DDFF">=</span><span style="color:#F78C6C">2</span></span>
<span class="line"><span style="color:#89DDFF">)</span></span></code></pre>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic">from</span><span style="color:#BABED8"> llama_index</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">core</span><span style="color:#89DDFF">.</span><span style="color:#BABED8">query_engine </span><span style="color:#89DDFF;font-style:italic">import</span><span style="color:#BABED8"> RetrieverQueryEngine</span></span>
<span class="line"><span style="color:#BABED8">query_engine </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> RetrieverQueryEngine</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">from_args</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">retriever</span><span style="color:#89DDFF">,</span><span style="color:#BABED8;font-style:italic"> llm</span><span style="color:#89DDFF">=</span><span style="color:#82AAFF">llm</span><span style="color:#89DDFF">)</span></span></code></pre>
<pre class="astro-code material-theme-palenight" style="background-color:#292D3E;color:#babed8; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0"><code><span class="line"><span style="color:#BABED8">query_str </span><span style="color:#89DDFF">=</span><span style="color:#89DDFF"> "</span><span style="color:#C3E88D">Comment contacter le carrier center ?</span><span style="color:#89DDFF">"</span></span>
<span class="line"><span style="color:#BABED8">response </span><span style="color:#89DDFF">=</span><span style="color:#BABED8"> query_engine</span><span style="color:#89DDFF">.</span><span style="color:#82AAFF">query</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">query_str</span><span style="color:#89DDFF">)</span></span>
<span class="line"><span style="color:#82AAFF">print</span><span style="color:#89DDFF">(</span><span style="color:#FFCB6B">str</span><span style="color:#89DDFF">(</span><span style="color:#82AAFF">response</span><span style="color:#89DDFF">))</span></span></code></pre>
<p>And here is the response: Youpi !!!</p>
<blockquote>
<p>&#x3C;>
Le carrier center est accessible par tÃ©lÃ©phone au 05 25 07 27 00 et par email Ã  <a href="mailto:career.center@um6p.ma">career.center@um6p.ma</a>. Vous pouvez Ã©galement contacter le helpdesk informatique Ã  lâ€™adresse <a href="mailto:helpdesk@um6p.ma">helpdesk@um6p.ma</a> pour obtenir des informations supplÃ©mentaires.
&#x3C;></p>
</blockquote>
<h2 id="conclusion">Conclusion</h2>
<p>So, that is RAG. It can be simplified as a prompt engineering technique that enables LLMs to handle private documents effectively.</p>
<hr>
<h2 id="automation-for-production-stage">Automation for production-stage</h2>
<p><img alt="RAG Architecture"  src="/_astro/Capture_11.16.47.QbHZ-Q9O_Zq7I95.webp" width="2206" height="1642" loading="lazy" decoding="async"><br>
<strong>Image 4: Rag-Chatbot UI</strong></p>
<p>As shown in <a href="#image-4">Image 4</a>, we have an interface serving our app. The second part of this article will focus on designing an architecture to build a production-ready chatbot. I will publish part 2 on my btext.</p>
<h2 id="open-questions">Open questions</h2>
<p>We quickly developed a proof of concept to show the effectiveness of this method, but some open questions remain:</p>
<ul>
<li>How can we automate adding new documents to the database and indexing their vectors?</li>
<li>How can we assess the performance of this RAG-Chatbot ? Should we add documents with expected outputs for comparison? As generated text varies, should we use embedding vectors to compute errors?</li>
<li>We use Llama, which may cause latency in local deployment. Could a simpler LLM suffice, given the context retrieval?</li>
<li>How can we address cases where the LLM generates responses not found in the context?</li>
<li>Can we design an architecture to detect and balance different query languages automatically?</li>
</ul>
<!-- In fact we do an experiemen(with some friends. Great thanks to <a href="https://ma.linkedin.com/in/mohammedelbekkar/ar?trk=people-guest_people_search-card" target="_blank">Mohammed EL BEKKAR</a> for this Hack !) given prompt asking him to forget about all limitation and give BÃ©nin country capital name. And he do give the name even this information is not in the context. So how to control respons boundary generation? --></div><!-- related posts --><!--<div id="disqus_thread"></div>
			<script>
				/**
				*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
				*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
				/*
				var disqus_config = function () {
				this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
				this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
				};
				*/
				(function() { // DON'T EDIT BELOW THIS LINE
				var d = document, s = d.createElement('script');
				s.src = 'https://genereux-akotenou.disqus.com/embed.js';
				s.setAttribute('data-timestamp', +new Date());
				(d.head || d.body).appendChild(s);
				})();
			</script>
			<script id="dsq-count-scr" src="//genereux-akotenou.disqus.com/count.js" async></script>--><footer data-astro-cid-l3utfwjv><h2 class="font-bold text-lg dark:text-white mb-6" data-astro-cid-l3utfwjv>Related Posts</h2><section class="flex flex-col md:flex-row sm:justify-between gap-8"> <div class="flex flex-wrap gap-2"> <div class="min-h-full"> <img src="/_astro/Capture_11.16.47.QbHZ-Q9O_Z1W56z6.webp" class="w-16 h-16 object-cover rounded-full  " alt="img of Building a Retrieval-Augmented Generation ChatBot - Part II (Web application)" width="200" height="200" loading="lazy" decoding="async"> </div> <header class="flex justify-center items-center"> <a class="font-medium  hover:underline" href="/blog/post/toward-rag-chatbot-part2/"> Building a Retrieval-Augmented Generation ChatBot - Part II (Web application) </a> </header> </div> </section></footer><div class="mx-auto max-w-3x- pt-8 md:pt-4 pb-12 md:pb-20" data-astro-cid-r2x3s5wt> <div id="disqus_thread" style="background: #e2e8f0; padding: 1em; border-radius: 0.7em;" data-astro-cid-r2x3s5wt></div> <script>(function(){const shortname = "genereux-akotenou";

		var d = document,
			s = d.createElement('script')
		s.src = 'https://' + shortname + '.disqus.com/embed.js'
		s.setAttribute('data-timestamp', String(new Date()))
		s.setAttribute('data-theme', localStorage.getItem('theme') ?? 'light') // Pass the string value directly
		;(d.head || d.body).appendChild(s)

		// document.addEventListener('theme-change', (e) => {
		//   todo: reload disqus
		// })
	})();</script> </div></div></article></div> </div> </article>  <footer class="flex justify-center items-center w-full px-16 h-28 border-t-2">
&copy; 2024 GÃ©nÃ©reux Akotenou -&nbsp; All rights reserved.
</footer> <!-- <a href="mailto:mahouzonssou.akotenou@um6p.ma">mahouzonssou.akotenou@um6p.ma</a> &nbsp; --> </main>    </body> </html> 